<?xml version="1.0" encoding="utf-8"?>
<DataSchemaModel FileFormatVersion="1.2" SchemaVersion="2.9" DspName="Microsoft.Data.Tools.Schema.Sql.SqlDwDatabaseSchemaProvider" CollationLcid="1033" CollationCaseSensitive="False" xmlns="http://schemas.microsoft.com/sqlserver/dac/Serialization/2012/02">
	<Header>
		<CustomData Category="AnsiNulls">
			<Metadata Name="AnsiNulls" Value="True" />
		</CustomData>
		<CustomData Category="QuotedIdentifier">
			<Metadata Name="QuotedIdentifier" Value="True" />
		</CustomData>
		<CustomData Category="CompatibilityMode">
			<Metadata Name="CompatibilityMode" Value="130" />
		</CustomData>
		<CustomData Category="Reference" Type="Assembly">
			<Metadata Name="LogicalName" Value="ME2.0.dll" />
			<Metadata Name="FileName" Value="C:\USERS\ANBERGST\SOURCE\REPOS\ME2.0\ME2.0\OBJ\DEBUG\ME2.0.DLL" />
			<Metadata Name="AssemblyName" Value="ME2.0" />
			<Metadata Name="PermissionSet" Value="SAFE" />
			<Metadata Name="Owner" Value="" />
			<Metadata Name="GenerateSqlClrDdl" Value="True" />
			<Metadata Name="IsVisible" Value="True" />
			<Metadata Name="IsModelAware" Value="True" />
			<Metadata Name="SkipCreationIfEmpty" Value="True" />
			<Metadata Name="AssemblySymbolsName" Value="C:\Users\anbergst\source\repos\ME2.0\ME2.0\obj\Debug\ME2.0.pdb" />
		</CustomData>
		<CustomData Category="SqlCmdVariables" Type="SqlCmdVariable" />
	</Header>
	<Model>
		<Element Type="SqlDatabaseOptions">
			<Property Name="Collation" Value="SQL_Latin1_General_CP1_CI_AS" />
			<Property Name="IsAnsiNullDefaultOn" Value="True" />
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="IsAnsiWarningsOn" Value="True" />
			<Property Name="IsArithAbortOn" Value="True" />
			<Property Name="IsConcatNullYieldsNullOn" Value="True" />
			<Property Name="IsTornPageProtectionOn" Value="False" />
			<Property Name="IsFullTextEnabled" Value="True" />
			<Property Name="PageVerifyMode" Value="3" />
			<Property Name="DefaultLanguage" Value="" />
			<Property Name="DefaultFullTextLanguage" Value="" />
			<Property Name="QueryStoreDesiredState" Value="0" />
			<Property Name="QueryStoreCaptureMode" Value="1" />
			<Property Name="QueryStoreStaleQueryThreshold" Value="367" />
			<Relationship Name="DefaultFilegroup">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[PRIMARY]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlDefaultConstraint">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[((0))]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[ME_Stage].[RawPartitionStage]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[ME_Stage].[RawPartitionStage].[Status]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="2" />
		</Element>
		<Element Type="SqlDefaultConstraint">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[((0))]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[ME_Config].[DataSet]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[ME_Config].[DataSet].[IsEnabled]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="3" />
		</Element>
		<Element Type="SqlSchema" Name="[ME_Config]">
			<Relationship Name="Authorizer">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlTable" Name="[ME_Config].[ActivityLog]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Config].[ActivityLog].[id]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bigint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Config].[ActivityLog].[EventSource]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Config].[ActivityLog].[EventSourceID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Config].[ActivityLog].[EventActivityName]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Config].[ActivityLog].[EventUTCTimestamp]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Config].[ActivityLog].[EventMessage]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1000" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[ME_Config]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineIndexAnnotation" Disambiguator="4" />
		</Element>
		<Element Type="SqlColumnStoreIndex" Name="[ME_Config].[ActivityLog].[ClusteredIndex_00000000000000000000000000000000]">
			<Property Name="IsClustered" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Config].[ActivityLog].[id]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Config].[ActivityLog].[EventSource]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Config].[ActivityLog].[EventSourceID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Config].[ActivityLog].[EventActivityName]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Config].[ActivityLog].[EventUTCTimestamp]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Config].[ActivityLog].[EventMessage]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[ME_Config].[ActivityLog]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="4" />
		</Element>
		<Element Type="SqlTable" Name="[ME_Config].[Connection]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Config].[Connection].[Id]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bigint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Config].[Connection].[ConnectionType]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Config].[Connection].[ConnectionName]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="250" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Config].[Connection].[ConnectionString]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Config].[Connection].[ConnectionKVSecret]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="250" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Config].[Connection].[ConnetionUserName]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[ME_Config]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineIndexAnnotation" Disambiguator="5" />
		</Element>
		<Element Type="SqlColumnStoreIndex" Name="[ME_Config].[Connection].[ClusteredIndex_00000000000000000000000000000000]">
			<Property Name="IsClustered" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Config].[Connection].[Id]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Config].[Connection].[ConnectionType]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Config].[Connection].[ConnectionName]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Config].[Connection].[ConnectionString]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Config].[Connection].[ConnectionKVSecret]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Config].[Connection].[ConnetionUserName]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[ME_Config].[Connection]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="5" />
		</Element>
		<Element Type="SqlTable" Name="[ME_Config].[DataSet]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Config].[DataSet].[Id]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bigint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Config].[DataSet].[DataSetType]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Config].[DataSet].[RunGroupCode]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Config].[DataSet].[DataSetName]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="250" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Config].[DataSet].[SchemaName]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Config].[DataSet].[TargetLake]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="250" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Config].[DataSet].[ConnectionId]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bigint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Config].[DataSet].[IsEnabled]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="3" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[ME_Config]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineIndexAnnotation" Disambiguator="6" />
		</Element>
		<Element Type="SqlColumnStoreIndex" Name="[ME_Config].[DataSet].[ClusteredIndex_00000000000000000000000000000000]">
			<Property Name="IsClustered" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Config].[DataSet].[Id]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Config].[DataSet].[DataSetType]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Config].[DataSet].[RunGroupCode]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Config].[DataSet].[DataSetName]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Config].[DataSet].[SchemaName]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Config].[DataSet].[TargetLake]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Config].[DataSet].[ConnectionId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Config].[DataSet].[IsEnabled]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[ME_Config].[DataSet]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="6" />
		</Element>
		<Element Type="SqlScalarFunction" Name="[ME_Config].[fnGetConfigurationSQLQuery]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[fnGetConfigurationSQLQuery].[@ConnectionType]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[fnGetConfigurationSQLQuery].[@ConnectionId]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="FunctionBody">
				<Entry>
					<Element Type="SqlScriptFunctionImplementation">
						<Property Name="BodyScript">
							<Value><![CDATA[
BEGIN
    -- Declare the return variable
	DECLARE @SQLQUERY VARCHAR(500)

/*Datatype Definition for Microsoft SQL Datatypes*/
IF @ConnectionType in ('MSSQL','MYSQL','AzMYSQL')
BEGIN
  SET @SQLQUERY = 'SELECT ''' + @ConnectionType + ''' AS DataSetType,  ' +
                          '''999''                    AS RunGroupCode, ' +
                          'TABLE_NAME                 AS DataSetName,  ' +
                          'TABLE_SCHEMA               AS SchemaName,   ' +
                          '''RAW''                    AS TargetLake,   ' +
                          '''' + cast(@ConnectionId as varchar) + '''  AS ConnectionId, ' +
                          '0                          AS IsEnabled ' +
                  ' FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = ''BASE TABLE'''
  IF @ConnectionType LIKE '%MYSQL'
    SET @SQLQUERY += ' AND TABLE_SCHEMA NOT IN (''mysql'',''performance_schema'',''sys'')'
END
ELSE IF @ConnectionType = 'ORACLE'
BEGIN
  SET @SQLQUERY = REPLACE(	'SELECT ¬' + @ConnectionType + '¬ AS DataSetType,  ' +
							'CAST(¬999¬ as int)			AS RunGroupCode, ' +
							'TABLE_NAME                 AS DataSetName,  ' +
							'OWNER                      AS SchemaName,   ' +
							'¬RAW¬						AS TargetLake,   ' +
							'CAST(¬' + cast(@ConnectionId as varchar) + '¬ as int)  AS ConnectionId, ' +
							'CAST(0 as int)				AS IsEnabled ' +
							' FROM ALL_TABLES WHERE TABLESPACE_NAME NOT IN (¬SYSTEM¬, ¬SYSAUX¬)'
						,'¬','''')
END							
ELSE
  SET @SQLQUERY = ''

-- Return the result of the function
RETURN @SQLQUERY
END]]></Value>
						</Property>
						<Annotation Type="SysCommentsObjectAnnotation">
							<Property Name="Length" Value="1749" />
							<Property Name="StartLine" Value="1" />
							<Property Name="StartColumn" Value="1" />
							<Property Name="HeaderContents" Value="CREATE FUNCTION [ME_Config].[fnGetConfigurationSQLQuery] (@ConnectionType [VARCHAR](50),@ConnectionId [bigint]) RETURNS VARCHAR(500)&#xD;&#xA;AS" />
						</Annotation>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[ME_Config].[fnGetConfigurationSQLQuery].[@ConnectionType]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[ME_Config].[fnGetConfigurationSQLQuery].[@ConnectionId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bigint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[ME_Config]" />
				</Entry>
			</Relationship>
			<Relationship Name="Type">
				<Entry>
					<Element Type="SqlTypeSpecifier">
						<Property Name="Length" Value="500" />
						<Relationship Name="Type">
							<Entry>
								<References ExternalSource="BuiltIns" Name="[varchar]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlScalarFunction" Name="[ME_Config].[fnGetDatatypedeff]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[fnGetDatatypedeff].[@DataSetType]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[fnGetDatatypedeff].[@DataType]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[fnGetDatatypedeff].[@Precision]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[fnGetDatatypedeff].[@SCALE]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[fnGetDatatypedeff].[@Size]" />
				</Entry>
			</Relationship>
			<Relationship Name="FunctionBody">
				<Entry>
					<Element Type="SqlScriptFunctionImplementation">
						<Property Name="BodyScript">
							<Value><![CDATA[
BEGIN
    -- Declare the return variable
	DECLARE @DATATYPEDEFF VARCHAR(500)
	
/*Datatype Definition for Microsoft SQL Datatypes*/


IF @DataSetType = 'MSSQL'
SET @DATATYPEDEFF =(
/*SELECT*/	CASE	WHEN	@DataType LIKE '%INT%' or
						@DataType LIKE 'bit' or
						--@DataType LIKE 'xml' or
						@DataType LIKE 'uniqueidentifier' or
						@DataType LIKE '%money%' or
						@DataType LIKE 'real' or
						(@DataType = 'float' and @Precision='53')

				THEN	@DataType
				WHEN	@DataType IN	(
										'DECIMAL'
										,'DEC'
										,'numeric'
										)
				THEN	@DataType + '('+@Precision+','+@SCALE+')'
				
				WHEN	@DataType LIKE '%var%' and @DataType != 'sql_variant'
				THEN	@DataType + '('+CASE WHEN @Size=-1 or @Size > 4000 Then 'MAX' ELSE @Size END + ')'

				WHEN	@DataType IN	(
										'datetime'
										,'date'
										,'smalldatetime'
										)
				THEN	@DataType 
				WHEN	@DataType IN	(
										'time'
										,'datetime2'
										,'datetimeoffset'
										)
				THEN	@DataType + '('+@SCALE+')'
				WHEN    @DataType LIKE 'xml'
				THEN	'VARCHAR(MAX)'
				ELSE	@DataType + '('+@Size+')'
		END
)

/*Datatype Definition for Oracle SQL Datatypes*/
IF @DataSetType = 'PLSQL'
SET @DATATYPEDEFF = @DataType + '('+@Size+')'

/*Datatype Definition for MySQL Datatypes*/
IF @DataSetType Like '%MySQL'
SET @DATATYPEDEFF = (
						CASE	
							/*Integer*/
							WHEN	(@DataType LIKE '%INT%' AND @DataType !='MEDIUMINT')  
							THEN	@DataType
				
							WHEN	@DataType ='MEDIUMINT'
							THEN	'INT'
							/*Decimal*/
							WHEN	@DataType =	'DECIMAL' and @Precision <= 38
							THEN	@DataType + '('+@Precision+','+@SCALE+')'
				
							WHEN	@DataType =	'DECIMAL' and @Precision > 38
							THEN	'FLOAT '
							
							/*Floating Point*/
							WHEN	@DataType IN ('DOUBLE','REAL')
							THEN	'float(53)'

							WHEN	@DataType ='FLOAT' AND ISNULL(@SCALE,-1) > 0
							THEN	'float(24)'
							WHEN	@DataType ='FLOAT' AND ISNULL(@SCALE,-1) <= 0
							THEN	'float('+@Precision+')'

							WHEN	(@DataType LIKE '%char' OR @DataType LIKE '%TEXT')
							THEN	@DataType + '('+CASE WHEN @Size=-1 or @Size > 4000 Then 'MAX' ELSE @Size END + ')'

							WHEN	@DataType IN	(
													'date'
													,'time'
													)
							THEN	@DataType 
							
							WHEN	@DataType = 'DATETIME'
							THEN	'datetime2'
							
							WHEN	@DataType = 'TIMESTAMP'
							THEN	'smalldatetime'
							
							WHEN	@DataType = 'YEAR'
							THEN	'smallint'
							
							WHEN    @DataType LIKE 'xml'
							THEN	'VARCHAR(MAX)'

							WHEN    (@DataType LIKE '%BINARY' OR @DataType LIKE '%BLOB')
							THEN    'varbinary'+ '('+CASE WHEN @Size=-1 or @Size > 4000 Then 'MAX' ELSE @Size END + ')'

							ELSE	@DataType + '('+@Size+')'
						END
					)

    -- Return the result of the function
    RETURN @DATATYPEDEFF
END]]></Value>
						</Property>
						<Annotation Type="SysCommentsObjectAnnotation">
							<Property Name="Length" Value="3147" />
							<Property Name="StartLine" Value="1" />
							<Property Name="StartColumn" Value="1" />
							<Property Name="HeaderContents" Value="CREATE FUNCTION [ME_Config].[fnGetDatatypedeff] (@DataSetType [VARCHAR](50),@DataType [VARCHAR](500),@Size [VARCHAR](20),@Precision [VARCHAR](20),@SCALE [VARCHAR](20)) RETURNS VARCHAR(500)&#xD;&#xA;AS" />
						</Annotation>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[ME_Config].[fnGetDatatypedeff].[@DataSetType]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[ME_Config].[fnGetDatatypedeff].[@DataType]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="500" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[ME_Config].[fnGetDatatypedeff].[@Size]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[ME_Config].[fnGetDatatypedeff].[@Precision]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[ME_Config].[fnGetDatatypedeff].[@SCALE]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[ME_Config]" />
				</Entry>
			</Relationship>
			<Relationship Name="Type">
				<Entry>
					<Element Type="SqlTypeSpecifier">
						<Property Name="Length" Value="500" />
						<Relationship Name="Type">
							<Entry>
								<References ExternalSource="BuiltIns" Name="[varchar]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlScalarFunction" Name="[ME_Config].[fnGetRMDBSQuery]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[fnGetRMDBSQuery].[@DataSetType]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[fnGetRMDBSQuery].[@DataSetID]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[fnGetRMDBSQuery].[@DataSetName]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[fnGetRMDBSQuery].[@SchemaName]" />
				</Entry>
			</Relationship>
			<Relationship Name="FunctionBody">
				<Entry>
					<Element Type="SqlScriptFunctionImplementation">
						<Property Name="BodyScript">
							<Value><![CDATA[
BEGIN
    -- Declare the return variable
    DECLARE @Query VARCHAR(MAX)

    -- T-SQL statements to compute the return value
IF @DataSetType IN ('MSSQL','MYSQL','AzMYSQL') SET @Query ='
SELECT	¬Dynamic¬ AS MetadataQuerySource
		,TABLE_NAME AS MetadataEntityName
		,TABLE_SCHEMA AS MetadataSchemaName
		,COLUMN_NAME AS MetadataObjectName
		,DATA_TYPE AS MetadataObjectType
		,CHARACTER_MAXIMUM_LENGTH AS MetadataObjectlength
		,FLOOR(NUMERIC_PRECISION) AS MetadataObjectPrecision
		,FLOOR(NUMERIC_SCALE) AS MetadataObjectScale
		,COALESCE(COLLATION_NAME,¬¬) AS MetadataObjectCollation
		,¬<DataSetID>¬ AS DataSetID
		,FLOOR(ORDINAL_POSITION) AS MetadataObjectOrder
		,¬0¬ AS MetadataObjectIdentityFlag
		,'+CASE WHEN @DataSetType IN ('MYSQL','AzMYSQL') THEN 'utc_timestamp()' ELSE 'GETUTCDATE()' END +' AS MetadataObjectRefreshUTCTimeStamp
				
FROM	INFORMATION_SCHEMA.COLUMNS
WHERE	TABLE_NAME = ¬<DataSetName>¬
		AND TABLE_SCHEMA = ¬<SchemaName>¬';
    -- T-SQL statements to compute the return value
	-- do we want CHAR_LENGTH or DATA_LENGTH ???
IF @DataSetType IN ('ORACLE') SET @Query ='
SELECT	¬Dynamic¬               AS "MetadataQuerySource"
		,TABLE_NAME             AS "MetadataEntityName"
		,OWNER                  AS "MetadataSchemaName"
		,COLUMN_NAME            AS "MetadataObjectName"
		,DATA_TYPE              AS "MetadataObjectType"
		,CHAR_LENGTH            AS "MetadataObjectlength"
		,FLOOR(DATA_PRECISION)  AS "MetadataObjectPrecision"
		,FLOOR(DATA_SCALE)      AS "MetadataObjectScale"
		,COALESCE(COLLATION,¬¬) AS "MetadataObjectCollation"
		,¬<DataSetID>¬          AS "DataSetID"
		,FLOOR(COLUMN_ID)       AS "MetadataObjectOrder"
		,¬0¬                    AS "MetadataObjectIdentityFlag"
		,'+CASE WHEN @DataSetType IN ('ORACLE') THEN 'LOCALTIMESTAMP AT TIME ZONE ¬UTC¬' END +' AS "MetadataObjectRefreshUTCTimeStamp"
				
FROM	ALL_TAB_COLUMNS
WHERE	TABLE_NAME = ¬<DataSetName>¬
		AND OWNER = ¬<SchemaName>¬';
SET @Query=REPLACE(@Query,'¬','''')
SET @Query=REPLACE(@Query,'<DataSetID>',@DataSetID)
SET @Query=REPLACE(@Query,'<DataSetName>',@DataSetName)
SET @Query=REPLACE(@Query,'<SchemaName>',@SchemaName)

    -- Return the result of the function
    RETURN @Query

	
END]]></Value>
						</Property>
						<Annotation Type="SysCommentsObjectAnnotation">
							<Property Name="Length" Value="2431" />
							<Property Name="StartLine" Value="1" />
							<Property Name="StartColumn" Value="1" />
							<Property Name="HeaderContents" Value="CREATE FUNCTION [ME_Config].[fnGetRMDBSQuery] (@DataSetID [VARCHAR](20),@DataSetName [VARCHAR](250),@SchemaName [VARCHAR](250),@DataSetType [VARCHAR](100)) RETURNS VARCHAR(4000)&#xD;&#xA;AS" />
						</Annotation>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[ME_Config].[fnGetRMDBSQuery].[@DataSetID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[ME_Config].[fnGetRMDBSQuery].[@DataSetName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="250" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[ME_Config].[fnGetRMDBSQuery].[@SchemaName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="250" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[ME_Config].[fnGetRMDBSQuery].[@DataSetType]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[ME_Config]" />
				</Entry>
			</Relationship>
			<Relationship Name="Type">
				<Entry>
					<Element Type="SqlTypeSpecifier">
						<Property Name="Length" Value="4000" />
						<Relationship Name="Type">
							<Entry>
								<References ExternalSource="BuiltIns" Name="[varchar]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlTable" Name="[ME_Config].[GLOBALS]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Config].[GLOBALS].[Attribute]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="200" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Config].[GLOBALS].[AttributeValue]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="4000" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[ME_Config]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineIndexAnnotation" Disambiguator="7" />
		</Element>
		<Element Type="SqlColumnStoreIndex" Name="[ME_Config].[GLOBALS].[ClusteredIndex_00000000000000000000000000000000]">
			<Property Name="IsClustered" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Config].[GLOBALS].[Attribute]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Config].[GLOBALS].[AttributeValue]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[ME_Config].[GLOBALS]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="7" />
		</Element>
		<Element Type="SqlProcedure" Name="[ME_Config].[sp_ADFGetDynamicRDBMSQuery]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN

SELECT	d.[DataSetType], 
		DBServerName=C.[ConnectionString],
		DBName=C.[ConnectionName],
		SQLKVName=C.[ConnectionKVSecret]
		,SqlUserName=C.[ConnetionUserName]
       ,[DataSetName]
      ,[SchemaName]
      ,DLContainer='metadata'
	  ,DLFolder='inbound'
	  ,DLFileName=LOWER(CONCAT(D.[SchemaName],'_',D.[DataSetName]))
      ,SQLQuery=	ME_Config.fnGetRMDBSQuery(
					CONVERT(VARCHAR(20),D.id), 
					CONVERT(VARCHAR(250),D.DataSetName),
					CONVERT(VARCHAR(250),D.SchemaName), 
					CONVERT(VARCHAR(100),D.DataSetType)
					)
      
FROM	[ME_Config].[DataSet] D
		INNER JOIN [ME_Config].[Connection] C ON D.[ConnectionId]=C.id

WHERE	D.DataSetType=@DataSetType
		AND (D.RunGroupCode=@RunGroupCode OR @RunGroupCode='-1')
		AND D.IsEnabled < 2

END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[ME_Config].[DataSet]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[Connection]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet].[ConnectionId]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[Connection].[Id]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet].[DataSetType]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[Connection].[ConnectionString]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[Connection].[ConnectionName]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[Connection].[ConnectionKVSecret]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[Connection].[ConnetionUserName]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet].[DataSetName]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet].[SchemaName]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet].[SchemaName]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet].[DataSetName]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet].[Id]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet].[DataSetType]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[fnGetRMDBSQuery]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[sp_ADFGetDynamicRDBMSQuery].[@DataSetType]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet].[RunGroupCode]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[sp_ADFGetDynamicRDBMSQuery].[@RunGroupCode]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet].[IsEnabled]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[ME_Config].[sp_ADFGetDynamicRDBMSQuery].[@DataSetType]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[ME_Config].[sp_ADFGetDynamicRDBMSQuery].[@RunGroupCode]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[ME_Config]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="898" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROC [ME_Config].[sp_ADFGetDynamicRDBMSQuery] @DataSetType [VARCHAR](100),@RunGroupCode [VARCHAR](20) AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[ME_Config].[sp_AlterGlobals]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN

TRUNCATE TABLE [ME_Config].[GLOBALS]

INSERT INTO [ME_Config].[GLOBALS]
SELECT Attribute='STORAGE_ACCOUNT',AttributeValue=@STORAGE_ACCOUNT
UNION ALL
SELECT Attribute='STAGE_SCHEMA',AttributeValue=@STAGE_SCHEMA
;

DECLARE @SQL VARCHAR(4000)

SET @SQL = 'CREATE SCHEMA ['+@STAGE_SCHEMA+']
    AUTHORIZATION [dbo];'


EXEC (@SQL)




END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[GLOBALS]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[sp_AlterGlobals].[@STORAGE_ACCOUNT]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[sp_AlterGlobals].[@STAGE_SCHEMA]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[ME_Config].[sp_AlterGlobals].[@STORAGE_ACCOUNT]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="4000" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[ME_Config].[sp_AlterGlobals].[@STAGE_SCHEMA]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="4000" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[ME_Config]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="471" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROC [ME_Config].[sp_AlterGlobals] @STORAGE_ACCOUNT [VARCHAR](4000),@STAGE_SCHEMA [VARCHAR](4000) AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[ME_Config].[sp_GENERATE_DynamicRMDBS_discoverSQL]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
SELECT SQLQuery=REPLACE('
SELECT ¬'+C.Connectiontype+'¬ AS DataSetType,¬999¬ AS RunGroupCode,TABLE_NAME AS DataSetName,TABLE_SCHEMA AS SchemaName
,¬RAW¬ AS TargetLake,¬'+CONVERT(VARCHAR(20),C.iD)+'¬ AS ConnectionId
,0 AS IsEnabled
  FROM INFORMATION_SCHEMA.TABLES
  WHERE TABLE_TYPE=¬BASE TABLE¬
  '+CASE WHEN C.Connectiontype='MYSQL' 
		THEN 'AND TABLE_SCHEMA NOT IN (¬mysql¬,¬performance_schema¬,¬sys¬) '
		ELSE '' END
,'¬','''')
  ,[DataSetType]=C.Connectiontype, 
		DBServerName=C.[ConnectionString],
		DBName=C.[ConnectionName],
		SQLKVName=C.[ConnectionKVSecret]
		,SqlUserName=C.[ConnetionUserName]
		  ,DLContainer='metadata'
	  ,DLFolder='me_config_dataset'
	  ,DLFileName=LOWER(CONCAT(C.[ConnectionName],'_',C.[ConnectionKVSecret]))
  FROM [ME_Config].[Connection] C
  Where C.id not in (SELECT ConnectionId From [ME_Config].[DataSet])
  and C.Connectiontype IN ('MSSQL','MYSQL')



  END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[ME_Config].[Connection]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[Connection].[ConnectionType]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[Connection].[Id]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[Connection].[ConnectionType]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[Connection].[ConnectionString]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[Connection].[ConnectionName]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[Connection].[ConnectionKVSecret]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[Connection].[ConnetionUserName]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[Connection].[ConnectionName]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[Connection].[ConnectionKVSecret]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[Connection].[Id]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet].[ConnectionId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[ME_Config]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="996" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROC [ME_Config].[sp_GENERATE_DynamicRMDBS_discoverSQL] AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[ME_Config].[sp_insertActivityEvent]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
DECLARE @UTCDATE AS DATETIME
SET @UTCDATE =  getUTCDATE()

INSERT INTO [ME_Config].[ActivityLog]
           ([EventSource]
           ,[EventSourceID]
           ,[EventActivityName]
           ,[EventUTCTimestamp]
           ,[EventMessage])
     VALUES
           (@EventSource,
           @EventSourceID,
           @EventActivityName,
           @UTCDATE,
           @EventMessage
		   )
END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[ActivityLog]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[ActivityLog].[EventSource]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[ActivityLog].[EventSourceID]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[ActivityLog].[EventActivityName]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[ActivityLog].[EventUTCTimestamp]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[ActivityLog].[EventMessage]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[sp_insertActivityEvent].[@EventSource]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[sp_insertActivityEvent].[@EventSourceID]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[sp_insertActivityEvent].[@EventActivityName]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[sp_insertActivityEvent].[@EventMessage]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[ME_Config].[sp_insertActivityEvent].[@EventSource]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[ME_Config].[sp_insertActivityEvent].[@EventSourceID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[ME_Config].[sp_insertActivityEvent].[@EventActivityName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[ME_Config].[sp_insertActivityEvent].[@EventMessage]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1000" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[ME_Config]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="592" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROC [ME_Config].[sp_insertActivityEvent] @EventSource [varchar](50),@EventSourceID [varchar](100),@EventActivityName [varchar](100),@EventMessage [varchar](1000) AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[ME_Config].[sp_LoadPrimeMetadata]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
	/*DEBUG
		SET @PARTITIONSTRING='2021/01/07/15/23'
		SET @DatasetID=25
*/
	/*DECLARE GLOBALS*/
	DECLARE @STORAGE_ACCOUNT VARCHAR(500)
	
	
	/*SET GLOBAL PARAMETERS*/
	SET @STORAGE_ACCOUNT =(SELECT TOP 1 AttributeValue	FROM ME_Config.GLOBALS WHERE [Attribute]='STORAGE_ACCOUNT')

	/*DECLARE LOCAL PARAMETERS*/
	DECLARE @SQLCOPYINTO VARCHAR(MAX);
	DECLARE @SourceConnnectionName VARCHAR(250)
	

	/*Get Source Database / Connection Name for use in target table name*/
	SET @SourceConnnectionName = ('https://'+@STORAGE_ACCOUNT+'.dfs.core.windows.net/metadata/me_config_dataset/*.parquet')
	


	/*Ensure Stage schema exists as defined in MF_Config.Globals*/
	
	/*Build out main metadata for dynamic SQL*/

/*Build out Copy Into Statement*/
	SET @SQLCOPYINTO = (REPLACE('COPY INTO dbo.tbdxxxxx
(DATASETTYPE 1, RUNGROUPCODE 2, DATASETNAME 3, SCHEMANAME 4, TARGETLAKE 5, CONNECTIONID 6, ISENABLED 7)
  
  FROM  ¬'+@SourceConnnectionName+ '¬
  WITH
(
	FILE_TYPE = ¬PARQUET¬
	,MAXERRORS = 0
	,IDENTITY_INSERT = ¬OFF¬
)

  ', '¬', '''')
		
			)
	
	/*Build Out Drop and Recreate of StageTable*/
	PRINT @SQLCOPYINTO



IF NOT EXISTS (SELECT * FROM sys.objects WHERE NAME = 'tbdxxxxx' AND TYPE = 'U')
CREATE TABLE dbo.tbdxxxxx
	(
	 [DATASETTYPE] nvarchar(300),
	 [RUNGROUPCODE] nvarchar(300),
	 [DATASETNAME] nvarchar(300),
	 [SCHEMANAME] nvarchar(300),
	 [TARGETLAKE] nvarchar(300),
	 [CONNECTIONID] nvarchar(300),
	 [ISENABLED] INT
	)
WITH
	(
	DISTRIBUTION = ROUND_ROBIN,
	 HEAP
	);





	EXEC (@SQLCOPYINTO)

	INSERT INTO [ME_Config].[DataSet]([DataSetType]
      ,[RunGroupCode]
      ,[DataSetName]
      ,[SchemaName]
      ,[TargetLake]
      ,[ConnectionId]
      ,[IsEnabled])
		SELECT * FROM dbo.tbdxxxxx;
DROP TABLE dbo.tbdxxxxx


	
END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[GLOBALS]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[GLOBALS].[AttributeValue]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[GLOBALS].[Attribute]" />
				</Entry>
				<Entry />
				<Entry />
				<Entry />
				<Entry />
				<Entry />
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry />
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry />
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry />
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry />
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry />
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry />
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet].[DataSetType]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet].[RunGroupCode]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet].[DataSetName]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet].[SchemaName]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet].[TargetLake]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet].[ConnectionId]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet].[IsEnabled]" />
				</Entry>
				<Entry />
				<Entry />
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[ME_Config]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1872" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROC [ME_Config].[sp_LoadPrimeMetadata] AS" />
			</Annotation>
		</Element>
		<Element Type="SqlSchema" Name="[ME_Data]">
			<Relationship Name="Authorizer">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlTable" Name="[ME_Data].[MetadataEntityStage]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Data].[MetadataEntityStage].[MetadataQuerySource]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Data].[MetadataEntityStage].[MetadataEntityName]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="250" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Data].[MetadataEntityStage].[MetadataSchemaName]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="250" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Data].[MetadataEntityStage].[MetadataObjectName]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="250" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Data].[MetadataEntityStage].[MetadataObjectType]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="250" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Data].[MetadataEntityStage].[MetadataObjectlength]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Data].[MetadataEntityStage].[MetadataObjectPrecision]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Data].[MetadataEntityStage].[MetadataObjectScale]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Data].[MetadataEntityStage].[MetadataObjectCollation]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="250" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Data].[MetadataEntityStage].[DataSetID]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Data].[MetadataEntityStage].[MetadataObjectOrder]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Data].[MetadataEntityStage].[MetadataObjectIdentityFlag]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Data].[MetadataEntityStage].[MetadataObjectRefreshUTCTimeStamp]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[ME_Data]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineIndexAnnotation" Disambiguator="8" />
		</Element>
		<Element Type="SqlColumnStoreIndex" Name="[ME_Data].[MetadataEntityStage].[ClusteredIndex_00000000000000000000000000000000]">
			<Property Name="IsClustered" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Data].[MetadataEntityStage].[MetadataQuerySource]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Data].[MetadataEntityStage].[MetadataEntityName]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Data].[MetadataEntityStage].[MetadataSchemaName]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Data].[MetadataEntityStage].[MetadataObjectName]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Data].[MetadataEntityStage].[MetadataObjectType]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Data].[MetadataEntityStage].[MetadataObjectlength]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Data].[MetadataEntityStage].[MetadataObjectPrecision]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Data].[MetadataEntityStage].[MetadataObjectScale]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Data].[MetadataEntityStage].[MetadataObjectCollation]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Data].[MetadataEntityStage].[DataSetID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Data].[MetadataEntityStage].[MetadataObjectOrder]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Data].[MetadataEntityStage].[MetadataObjectIdentityFlag]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Data].[MetadataEntityStage].[MetadataObjectRefreshUTCTimeStamp]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[ME_Data].[MetadataEntityStage]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="8" />
		</Element>
		<Element Type="SqlProcedure" Name="[ME_Data].[sp_ADFGetSQLConfig]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN

SELECT	d.[DataSetType], 
		DBServerName=C.[ConnectionString],
		DBName=C.[ConnectionName],
		SQLKVName=C.[ConnectionKVSecret]
		,SqlUserName=C.[ConnectionKVSecret]
       ,D.[DataSetName]
      ,D.[SchemaName]
      ,DLContainer=LOWER(E.TargetLake)
	  ,DLFolder=LOWER(E.LakeFolder)
	  ,DLFileName=LOWER(CONCAT(D.[SchemaName],'_',D.[DataSetName]))
      ,SQLQuery=CONVERT(NVARCHAR(MAX),'SELECT '+COLS.Cols/*[ME_Config].[fnGetRMDBSQuerySelectColumnNames](E.Id)*/+' FROM ['+E.[SchemaName]+'].['+E.[Name]+']')
      
FROM	[ME_Config].[DataSet] D
		INNER JOIN [ME_Config].[Connection] C ON D.[ConnectionId]=C.id
		INNER JOIN Metadata.Entity E ON D.Id=E.DatasetId AND D.[IsEnabled]=1
		INNER JOIN (   
					SELECT Cols=CONVERT(NVARCHAR(MAX),(ISNULL	(
						STRING_AGG('['+REPLACE([MetadataObjectName],' ','_')+']=['+[MetadataObjectName]+']',',')
						WITHIN GROUP ( ORDER BY [MetadataObjectOrder]  ASC  )
						,'*'
						))),EntityID
					FROM MEtadata.[object] 
					Where EntityID IN (
					SELECT DISTINCT EntityID 
					FROM MEtadata.[object] 
					where [MetadataObjectName] LIKE '% %'
										) 
										GROUP BY EntityID
					 
					) AS COLS ON COLS.EntityID=E.Id

WHERE	D.DataSetType=@DataSetType
		AND (D.RunGroupCode=@RunGroupCode OR @RunGroupCode='-1')
		AND D.IsEnabled < 2

END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[ME_Config].[DataSet]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[Connection]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet].[ConnectionId]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[Connection].[Id]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet].[Id]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[DataSetId]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet].[IsEnabled]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Object]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Object].[MetadataObjectName]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Object].[MetadataObjectOrder]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Object].[EntityId]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Object].[EntityId]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Object].[MetadataObjectName]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[Id]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet].[DataSetType]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[Connection].[ConnectionString]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[Connection].[ConnectionName]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[Connection].[ConnectionKVSecret]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[Connection].[ConnectionKVSecret]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet].[DataSetName]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet].[SchemaName]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[TargetLake]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[LakeFolder]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[SchemaName]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[Name]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet].[DataSetType]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ADFGetSQLConfig].[@DataSetType]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet].[RunGroupCode]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ADFGetSQLConfig].[@RunGroupCode]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[ME_Data].[sp_ADFGetSQLConfig].[@DataSetType]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[ME_Data].[sp_ADFGetSQLConfig].[@RunGroupCode]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[ME_Data]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1438" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROC [ME_Data].[sp_ADFGetSQLConfig] @DataSetType [VARCHAR](100),@RunGroupCode [VARCHAR](20) AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[ME_Data].[sp_GetDynamicMSSQLQuery]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
	DECLARE @PARTITION VARCHAR(50)

	SET @PARTITION = (
			SELECT REPLACE(REPLACE(REPLACE(CONVERT(VARCHAR(16), GETUTCDATE(), 120), '-', '\'), ' ', '\'), ':', '\')
			)

	SELECT [DataSetType]
		,DBServerName
		,DBName
		,SQLKVName
		,SqlUserName
		,[DataSetName]
		,[SchemaName]
		,DLContainer
		,DLFolder = DLFolder + '\' + @PARTITION
		,DLFileName
		,SQLQuery = CONVERT(NVARCHAR(MAX), 'SELECT ' + Cols + CASE 
				WHEN [DataSetType] LIKE '%MSSQL'
					THEN ' FROM [' + [SchemaName] + '].[' + [Name] + ']'
				WHEN [DataSetType] LIKE '%ORACLE'
					THEN ' FROM "' + [SchemaName] + '"."' + [Name] + '"'
				ELSE ' FROM `' + [SchemaName] + '`.`' + [Name] + '`'
				END + WhereClause)
		,Cols
		,DataSetID = ID
		,[Target_Partition] = REPLACE(@PARTITION, '\', '/')
	FROM (
		SELECT d.[DataSetType]
			,DBServerName = C.[ConnectionString]
			,DBName = C.[ConnectionName]
			,SQLKVName = C.[ConnectionKVSecret]
			,SqlUserName = C.[ConnetionUserName]
			,D.[DataSetName]
			,D.[SchemaName]
			,DLContainer = LOWER(E.TargetLake)
			,DLFolder = LOWER(E.LakeFolder)
			,DLFileName = LOWER(CONCAT (
					D.[SchemaName]
					,'_'
					,D.[DataSetName]
					))
			,E.[Name]
			,D.ID
			--
			,Cols = CONVERT(NVARCHAR(MAX), (
					ISNULL(STRING_AGG((
								CASE 
									WHEN d.[DataSetType] = 'MSSQL'
										THEN '[' + o.[MetadataObjectName] + ']  AS [' + REPLACE(o.[MetadataObjectName], ' ', '_') + ']'
									WHEN d.[DataSetType] = 'ORACLE'
										THEN '"' + o.[MetadataObjectName] + '"  AS "' + REPLACE(o.[MetadataObjectName], ' ', '_') + '"'
									ELSE '`' + o.[MetadataObjectName] + '`  AS `' + REPLACE(o.[MetadataObjectName], ' ', '_') + '`'
									END
								), ',') WITHIN GROUP (
							ORDER BY o.[MetadataObjectOrder] ASC
							), '*')
					))
			,WhereClause = CASE 
				WHEN DC.EntityID IS NULL
					THEN ''
				ELSE CONCAT (
						' Where '
						,' '
						,DC.WhereCol
						,' '
						,DC.WhereOperator
						,' '
						,DC.wherevalue
						,' '
						)
				END
		--SELECT *
		FROM [Metadata].[Entity] E
		INNER JOIN [ME_Config].[DataSet] D ON D.id = e.datasetid
			AND D.[IsEnabled] = 1
			AND d.[DataSetType] LIKE @DataSetType
		INNER JOIN [ME_Config].[Connection] C ON D.CONNECTIONID = C.ID
		INNER JOIN [Metadata].[Object] o ON o.EntityID = E.id
		LEFT OUTER JOIN Metadata.DeltaConfig DC ON DC.EntityID = E.id
		GROUP BY d.[DataSetType]
			,C.[ConnectionString]
			,C.[ConnectionName]
			,C.[ConnectionKVSecret]
			,C.[ConnectionKVSecret]
			,D.[DataSetName]
			,D.[SchemaName]
			,LOWER(E.TargetLake)
			,LOWER(E.LakeFolder)
			,LOWER(CONCAT (
					D.[SchemaName]
					,'_'
					,D.[DataSetName]
					))
			,E.[Name]
			,D.ID
			,C.[ConnetionUserName]
			,CASE 
				WHEN DC.EntityID IS NULL
					THEN ''
				ELSE CONCAT (
						' Where '
						,' '
						,DC.WhereCol
						,' '
						,DC.WhereOperator
						,' '
						,DC.wherevalue
						,' '
						)
				END
		) AS X
END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet].[Id]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[DataSetId]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet].[IsEnabled]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet].[DataSetType]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_GetDynamicMSSQLQuery].[@DataSetType]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[Connection]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet].[ConnectionId]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[Connection].[Id]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Object]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Object].[EntityId]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[Id]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[DeltaConfig]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[DeltaConfig].[Entityid]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[Id]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet].[DataSetType]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[Connection].[ConnectionString]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[Connection].[ConnectionName]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[Connection].[ConnectionKVSecret]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[Connection].[ConnetionUserName]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet].[DataSetName]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet].[SchemaName]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[TargetLake]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[LakeFolder]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[Name]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet].[Id]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Object].[MetadataObjectName]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Object].[MetadataObjectOrder]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[DeltaConfig].[WhereCol]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[DeltaConfig].[WhereOperator]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[DeltaConfig].[wherevalue]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[Connection].[ConnectionString]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[Connection].[ConnectionName]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[Connection].[ConnectionKVSecret]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[Connection].[ConnetionUserName]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet].[DataSetType]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[Connection].[ConnectionString]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[Connection].[ConnectionName]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[Connection].[ConnectionKVSecret]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[Connection].[ConnetionUserName]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet].[DataSetName]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet].[SchemaName]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[Name]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet].[Id]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[ME_Data].[sp_GetDynamicMSSQLQuery].[@DataSetType]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[ME_Data].[sp_GetDynamicMSSQLQuery].[@ExecutionGroup]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="10" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[ME_Data].[sp_GetDynamicMSSQLQuery].[@ExecutionPlane]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="10" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[ME_Data]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="3158" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROC [ME_Data].[sp_GetDynamicMSSQLQuery] @DataSetType [VARCHAR](100),@ExecutionGroup [VARCHAR](10),@ExecutionPlane [VARCHAR](10) AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
--Initial Reset... 
BEGIN TRY 
DROP TABLE #TTAttribute
DROP TABLE #TTBase
DROP TABLE #TTOBJECT
DROP TABLE #TTEntity
DROP TABLE #Attribute
DROP TABLE #OBJECT
DROP TABLE #Entity
END TRY
BEGIN CATCH
PRINT 'Seems as if the temp tables were not there :)'
END CATCH




--Lock In Reslults
SELECT [MetadataQuerySource]
      ,[MetadataEntityName]
      ,[MetadataSchemaName]
      ,[MetadataObjectName]
      ,[MetadataObjectType]
      ,[MetadataObjectlength]
      ,[MetadataObjectPrecision]
      ,[MetadataObjectScale]
      ,[MetadataObjectCollation]
      ,[DataSetID]
      ,[MetadataObjectOrder]
      ,[MetadataObjectIdentityFlag]
      ,[MetadataObjectRefreshUTCTimeStamp]

	  ,MetadataObjectHash=CONVERT(BIGINT,HASHBYTES('SHA1',CONCAT([DataSetID],'¬'
      ,[MetadataObjectName])))
	   
	INTO #TTBase
	--SELECT *
  FROM [ME_Data].[MetadataEntityStage]
  WHERE [MetadataQuerySource]='Dynamic' 
		AND DATASETID IN	(
							SELECT id 
							from [ME_Config].[DataSet] 
							where @DataSetType=DataSetType
							)

--Get All Distinct Entities
--DROP TABLE #TTEntity
SELECT DISTINCT [DataSetID],[MetadataEntityName]
      ,[MetadataSchemaName]
INTO #TTEntity
FROM #TTBase

--Build Up Objects
SELECT [DataSetID]
      ,[MetadataObjectName]
	  ,[MetadataObjectOrder]
	  ,MetadataObjectHash
	  ,[MetadataObjectRefreshUTCTimeStamp]=MAX([MetadataObjectRefreshUTCTimeStamp])
INTO #TTOBJECT
FROM #TTBase
GROUP BY [DataSetID]
      ,[MetadataObjectName]
	  ,MetadataObjectHash
	  ,[MetadataObjectOrder]


--Build Attribute KVP Table
SELECT *
INTO #TTAttribute
FROM (
SELECT	 MetadataObjectHash
		,[DataSetID]
		,[KEY]=CONVERT(VARCHAR(100),'ObjectDataType')
		,[Value]=CONVERT(NVARCHAR(4000),[MetadataObjectType])
		,[KeyValueDataType]=CONVERT(VARCHAR(50),'String')
		,[KeyValueRefreshDate]=[MetadataObjectRefreshUTCTimeStamp]
FROM #TTBase
UNION ALL
SELECT	 MetadataObjectHash
		,[DataSetID]
		,[KEY]=CONVERT(VARCHAR(100),'ObjectDataTypeSize')
		,[Value]=CONVERT(NVARCHAR(4000),MetadataObjectlength)
		,[KeyValueDataType]='Int'
		,[KeyValueRefreshDate]=[MetadataObjectRefreshUTCTimeStamp]
FROM #TTBase
UNION ALL
SELECT	 MetadataObjectHash
		,[DataSetID]
		,[KEY]=CONVERT(VARCHAR(100),'ObjectDataTypePrecision')
		,[Value]=CONVERT(NVARCHAR(4000),MetadataObjectPrecision)
		,[KeyValueDataType]='Int'
		,[KeyValueRefreshDate]=[MetadataObjectRefreshUTCTimeStamp]
FROM #TTBase
UNION ALL
SELECT	 MetadataObjectHash
		,[DataSetID]
		,[KEY]=CONVERT(VARCHAR(100),'ObjectDataTypeScale')
		,[Value]=CONVERT(NVARCHAR(4000),MetadataObjectScale)
		,[KeyValueDataType]='Int'
		,[KeyValueRefreshDate]=[MetadataObjectRefreshUTCTimeStamp]
FROM #TTBase
UNION ALL
SELECT	 MetadataObjectHash
		,[DataSetID]
		,[KEY]=CONVERT(VARCHAR(100),'ObjectDataTypeCollation')
		,[Value]=CONVERT(NVARCHAR(4000),MetadataObjectCollation)
		,[KeyValueDataType]='String'
		,[KeyValueRefreshDate]=[MetadataObjectRefreshUTCTimeStamp]
FROM #TTBase
WHERE ISNULL(MetadataObjectCollation,'') !=''
UNION ALL
SELECT	 MetadataObjectHash
		,[DataSetID]
		,[KEY]=CONVERT(VARCHAR(100),'ObjectIdentityFlag')
		,[Value]=CONVERT(NVARCHAR(4000),MetadataObjectIdentityFlag)
		,[KeyValueDataType]='Int'
		,[KeyValueRefreshDate]=[MetadataObjectRefreshUTCTimeStamp]
FROM #TTBase
) X



SELECT E.*,D.TargetLake,LakeFolder=CONCAT(D.id
								,'\'
								,D.DataSetType
								,'\'
								,E.[MetadataSchemaName]
								,'\'
								,E.[MetadataEntityName]) 
		,RecordProcessTimestamp=GETUTCDATE()
INTO #Entity
FROM #TTEntity E
INNER JOIN [ME_Config].[DataSet] D ON D.id=E.DataSetID

SELECT * ,RecordProcessTimestamp=GETUTCDATE()
INTO #Object
FROM #TTOBJECT

SELECT * ,RecordProcessTimestamp=GETUTCDATE()
INTO #Attribute
FROM #TTAttribute


--Update Metadata.Entity table
UPDATE t
SET 
       t.[Name]=s.[MetadataEntityName]
      ,t.[SchemaName]=s.[MetadataSchemaName]
      ,t.[TargetLake]=s.[TargetLake]
      ,t.[LakeFolder]=s.[LakeFolder]
      ,t.[RecordProcessTimestamp]=s.[RecordProcessTimestamp]
FROM [Metadata].[Entity] t 
INNER JOIN  #Entity s ON s.[DataSetId] = t.[DataSetId]


	INSERT INTO [Metadata].[Entity] ([DataSetId]
      ,[Name]
      ,[SchemaName]
      ,[TargetLake]
      ,[LakeFolder]
      ,[RecordProcessTimestamp]
	  ,CreatedUTCTimestamp)
	  SELECT DISTINCT s.[DataSetId]
      ,s.[MetadataEntityName]
      ,s.[MetadataSchemaName]
      ,s.[TargetLake]
      ,s.[LakeFolder]
      ,s.[RecordProcessTimestamp]
	  ,CreatedUTCTimestamp=GETUTCDATE()
	  FROM #Entity s 
	  LEFT OUTER JOIN  [Metadata].[Entity] t
	  ON s.[DataSetId] = t.[DataSetId]
	  WHERE t.[DataSetId] IS NULL
	;
	  /*
MERGE [Metadata].[Entity] t 
    USING #Entity s
ON (s.[DataSetId] = t.[DataSetId])
WHEN MATCHED
    THEN UPDATE SET 
       t.[Name]=s.[MetadataEntityName]
      ,t.[SchemaName]=s.[MetadataSchemaName]
      ,t.[TargetLake]=s.[TargetLake]
      ,t.[LakeFolder]=s.[LakeFolder]
      ,t.[RecordProcessTimestamp]=s.[RecordProcessTimestamp]



            
WHEN NOT MATCHED --BY TARGET 
    THEN INSERT ([DataSetId]
      ,[Name]
      ,[SchemaName]
      ,[TargetLake]
      ,[LakeFolder]
      ,[RecordProcessTimestamp])
         VALUES (s.[DataSetId]
      ,s.[MetadataEntityName]
      ,s.[MetadataSchemaName]
      ,s.[TargetLake]
      ,s.[LakeFolder]
      ,s.[RecordProcessTimestamp])
	  */
	;

	

--Update Metadata Object Table 

UPDATE t
SET 
        t.[MetadataObjectOrder]		=s.[MetadataObjectOrder]
       ,t.[RecordProcessTimestamp]	=s.[RecordProcessTimestamp]
FROM [Metadata].[Object] t 
INNER JOIN  (
			SELECT o.*, [EntityId]=E.id 
			FROM #Object o 
			INNER JOIN [Metadata].[Entity] E 
			ON E.[DataSetId]=o.[DataSetId]
			) s ON s.[MetadataObjectHash] = t.[MetadataObjectHash];

INSERT INTO [Metadata].[Object]([EntityId]
				,[DataSetID]
				,[MetadataObjectName]
				,[MetadataObjectOrder]
				,[MetadataObjectHash]
				,[MetadataObjectRefreshUTCTimeStamp]
				,[RecordProcessTimestamp]
				,CreatedUTCTimestamp
				)
         SELECT s.[EntityId]
				,s.[DataSetID]
				,s.[MetadataObjectName]
				,s.[MetadataObjectOrder]
				,s.[MetadataObjectHash]
				,s.[MetadataObjectRefreshUTCTimeStamp]
				,s.[RecordProcessTimestamp]
				,CreatedUTCTimestamp=GETUTCDATE()
	FROM   (
			SELECT o.*, [EntityId]=E.id 
			FROM #Object o 
			INNER JOIN [Metadata].[Entity] E 
			ON E.[DataSetId]=o.[DataSetId]
			) s 
	WHERE s.[MetadataObjectHash] NOT IN (SELECT [MetadataObjectHash] FROM [Metadata].[Object] WITH (NOLOCK))
	


/*
MERGE [Metadata].[Object] t 
    USING	(
			SELECT o.*, [EntityId]=E.id 
			FROM #Object o 
			INNER JOIN [Metadata].[Entity] E 
			ON E.[DataSetId]=o.[DataSetId]
			) s
ON (s.[MetadataObjectHash] = t.[MetadataObjectHash])
WHEN MATCHED
    THEN UPDATE SET 
       t.[MetadataObjectOrder]		=s.[MetadataObjectOrder]
       ,t.[RecordProcessTimestamp]	=s.[RecordProcessTimestamp]
            
WHEN NOT MATCHED BY TARGET 
    THEN INSERT ([EntityId]
				,[DataSetID]
				,[MetadataObjectName]
				,[MetadataObjectOrder]
				,[MetadataObjectHash]
				,[MetadataObjectRefreshUTCTimeStamp]
				,[RecordProcessTimestamp]
				)
         VALUES (s.[EntityId]
				,s.[DataSetID]
				,s.[MetadataObjectName]
				,s.[MetadataObjectOrder]
				,s.[MetadataObjectHash]
				,s.[MetadataObjectRefreshUTCTimeStamp]
				,s.[RecordProcessTimestamp])
	;

	*/

--Update Metadata Attribute Table 

UPDATE t
SET 
        t.[Value]=s.[Value]
       ,t.[KeyValueRefreshDate]=s.[KeyValueRefreshDate]
       ,t.[RecordProcessTimestamp]	=s.[RecordProcessTimestamp]
FROM [Metadata].[Attribute] t 
INNER JOIN  (
			SELECT o.*, [EntityId]=E.[EntityId] ,[ObjectId]=E.[Id] 
			FROM #Attribute o 
			INNER JOIN [Metadata].[Object] E 
			ON E.[MetadataObjectHash]=o.[MetadataObjectHash]
			) s ON (s.[MetadataObjectHash] = t.[MetadataObjectHash] and S.[Key]=T.[Key]);


INSERT INTO [Metadata].[Attribute] ([EntityId]
				,[ObjectId]
				,[MetadataObjectHash]
				,[DataSetID]
				,[KEY]
				,[Value]
				,[KeyValueDataType]
				,[KeyValueRefreshDate]
				,[RecordProcessTimestamp]
				,CreatedUTCTimestamp
				)
			SELECT s.[EntityId]
				,s.[ObjectId]
				,s.[MetadataObjectHash]
				,s.[DataSetID]
				,s.[KEY]
				,s.[Value]
				,s.[KeyValueDataType]
				,s.[KeyValueRefreshDate]
				,s.[RecordProcessTimestamp]
				,CreatedUTCTimestamp=GETUTCDATE()
			FROM 
			(
				SELECT o.*, [EntityId]=E.[EntityId] ,[ObjectId]=E.[Id] 
				FROM #Attribute o 
				INNER JOIN [Metadata].[Object] E 
				ON E.[MetadataObjectHash]=o.[MetadataObjectHash]
			) s 
			LEFT OUTER JOIN [Metadata].[Attribute]  t ON s.[MetadataObjectHash] = t.[MetadataObjectHash] and S.[Key]=T.[Key] 
			WHERE t.[MetadataObjectHash] IS NULL;
/*
MERGE [Metadata].[Attribute] t 
    USING	(
			SELECT o.*, [EntityId]=E.[EntityId] ,[ObjectId]=E.[Id] 
			FROM #Attribute o 
			INNER JOIN [Metadata].[Object] E 
			ON E.[MetadataObjectHash]=o.[MetadataObjectHash]
			) s
ON (s.[MetadataObjectHash] = t.[MetadataObjectHash] and S.[Key]=T.[Key])
WHEN MATCHED
    THEN UPDATE SET 
		t.[Value]=s.[Value]
       ,t.[KeyValueRefreshDate]=s.[KeyValueRefreshDate]
       ,t.[RecordProcessTimestamp]	=s.[RecordProcessTimestamp]
            
WHEN NOT MATCHED BY TARGET 
    THEN INSERT ([EntityId]
				,[ObjectId]
				,[MetadataObjectHash]
				,[DataSetID]
				,[KEY]
				,[Value]
				,[KeyValueDataType]
				,[KeyValueRefreshDate]
				,[RecordProcessTimestamp]
				)
         VALUES (s.[EntityId]
				,s.[ObjectId]
				,s.[MetadataObjectHash]
				,s.[DataSetID]
				,s.[KEY]
				,s.[Value]
				,s.[KeyValueDataType]
				,s.[KeyValueRefreshDate]
				,s.[RecordProcessTimestamp])
	;
	*/
--Purge stage table of data
DELETE  FROM [ME_Data].[MetadataEntityStage]
WHERE CONVERT(BIGINT,HASHBYTES('SHA1',CONCAT([DataSetID],'¬'
      ,[MetadataObjectName]))) IN (SELECT DISTINCT MetadataObjectHash FROM #TTBase)
--Cleanup
DROP TABLE #TTAttribute
DROP TABLE #TTBase
DROP TABLE #TTOBJECT
DROP TABLE #TTEntity
DROP TABLE #Attribute
DROP TABLE #OBJECT
DROP TABLE #Entity

END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTAttribute]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTBase]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTOBJECT]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTEntity]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Attribute]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Object]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Entity]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[MetadataEntityStage]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[MetadataEntityStage].[MetadataQuerySource]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[MetadataEntityStage].[MetadataEntityName]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[MetadataEntityStage].[MetadataSchemaName]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[MetadataEntityStage].[MetadataObjectName]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[MetadataEntityStage].[MetadataObjectType]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[MetadataEntityStage].[MetadataObjectlength]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[MetadataEntityStage].[MetadataObjectPrecision]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[MetadataEntityStage].[MetadataObjectScale]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[MetadataEntityStage].[MetadataObjectCollation]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[MetadataEntityStage].[DataSetID]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[MetadataEntityStage].[MetadataObjectOrder]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[MetadataEntityStage].[MetadataObjectIdentityFlag]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[MetadataEntityStage].[MetadataObjectRefreshUTCTimeStamp]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bigint]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet].[Id]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[@DataSetType]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet].[DataSetType]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTBase].[DataSetID]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTBase].[MetadataEntityName]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTBase].[MetadataSchemaName]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTBase].[MetadataObjectName]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTBase].[MetadataObjectOrder]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTBase].[MetadataObjectHash]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTBase].[MetadataObjectRefreshUTCTimeStamp]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTBase].[MetadataObjectHash]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTBase].[DataSetID]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTBase].[MetadataObjectType]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTBase].[MetadataObjectRefreshUTCTimeStamp]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTBase].[MetadataObjectlength]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTBase].[MetadataObjectPrecision]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTBase].[MetadataObjectScale]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTBase].[MetadataObjectCollation]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTBase].[MetadataObjectIdentityFlag]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet].[Id]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTEntity].[DataSetID]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet].[TargetLake]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet].[DataSetType]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTEntity].[MetadataSchemaName]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTEntity].[MetadataEntityName]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Entity].[DataSetID]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[DataSetId]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[Name]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Entity].[MetadataEntityName]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[SchemaName]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Entity].[MetadataSchemaName]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[TargetLake]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Entity].[TargetLake]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[LakeFolder]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Entity].[LakeFolder]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[RecordProcessTimestamp]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Entity].[RecordProcessTimestamp]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[DataSetId]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[Name]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[SchemaName]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[TargetLake]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[LakeFolder]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[RecordProcessTimestamp]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[CreatedUTCTimestamp]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Object]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[DataSetId]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Object].[DataSetID]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[Id]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Object].[MetadataObjectHash]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Object].[MetadataObjectHash]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Object].[MetadataObjectOrder]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Object].[MetadataObjectOrder]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Object].[RecordProcessTimestamp]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Object].[RecordProcessTimestamp]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Object].[EntityId]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Object].[DataSetID]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Object].[MetadataObjectName]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Object].[MetadataObjectOrder]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Object].[MetadataObjectHash]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Object].[MetadataObjectRefreshUTCTimeStamp]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Object].[RecordProcessTimestamp]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Object].[CreatedUTCTimestamp]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[Id]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Object].[DataSetID]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Object].[MetadataObjectName]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Object].[MetadataObjectOrder]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Object].[MetadataObjectHash]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Object].[MetadataObjectRefreshUTCTimeStamp]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Object].[RecordProcessTimestamp]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Object].[MetadataObjectHash]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Object].[MetadataObjectHash]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Attribute].[MetadataObjectHash]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Object].[EntityId]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Object].[Id]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Attribute].[MetadataObjectHash]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[MetadataObjectHash]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Attribute].[KEY]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[KEY]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[Value]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Attribute].[Value]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[KeyValueRefreshDate]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Attribute].[KeyValueRefreshDate]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[RecordProcessTimestamp]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Attribute].[RecordProcessTimestamp]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[EntityId]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[ObjectId]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[MetadataObjectHash]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[DataSetID]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[KEY]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[Value]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[KeyValueDataType]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[KeyValueRefreshDate]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[RecordProcessTimestamp]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[CreatedUTCTimestamp]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Object].[EntityId]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Object].[Id]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Attribute].[DataSetID]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Attribute].[KEY]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Attribute].[KeyValueDataType]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bigint]" />
				</Entry>
				<Entry>
					<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTBase].[MetadataObjectHash]" />
				</Entry>
			</Relationship>
			<Relationship Name="DynamicObjects">
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTBase]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTBase].[MetadataQuerySource]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[ME_Data].[MetadataEntityStage].[MetadataQuerySource]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTBase].[MetadataEntityName]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[ME_Data].[MetadataEntityStage].[MetadataEntityName]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTBase].[MetadataSchemaName]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[ME_Data].[MetadataEntityStage].[MetadataSchemaName]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTBase].[MetadataObjectName]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[ME_Data].[MetadataEntityStage].[MetadataObjectName]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTBase].[MetadataObjectType]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[ME_Data].[MetadataEntityStage].[MetadataObjectType]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTBase].[MetadataObjectlength]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[ME_Data].[MetadataEntityStage].[MetadataObjectlength]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTBase].[MetadataObjectPrecision]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[ME_Data].[MetadataEntityStage].[MetadataObjectPrecision]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTBase].[MetadataObjectScale]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[ME_Data].[MetadataEntityStage].[MetadataObjectScale]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTBase].[MetadataObjectCollation]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[ME_Data].[MetadataEntityStage].[MetadataObjectCollation]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTBase].[DataSetID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[ME_Data].[MetadataEntityStage].[DataSetID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTBase].[MetadataObjectOrder]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[ME_Data].[MetadataEntityStage].[MetadataObjectOrder]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTBase].[MetadataObjectIdentityFlag]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[ME_Data].[MetadataEntityStage].[MetadataObjectIdentityFlag]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTBase].[MetadataObjectRefreshUTCTimeStamp]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[ME_Data].[MetadataEntityStage].[MetadataObjectRefreshUTCTimeStamp]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTBase].[MetadataObjectHash]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTEntity]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTEntity].[DataSetID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTBase].[DataSetID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTEntity].[MetadataEntityName]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTBase].[MetadataEntityName]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTEntity].[MetadataSchemaName]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTBase].[MetadataSchemaName]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTOBJECT]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTOBJECT].[DataSetID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTBase].[DataSetID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTOBJECT].[MetadataObjectName]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTBase].[MetadataObjectName]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTOBJECT].[MetadataObjectOrder]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTBase].[MetadataObjectOrder]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTOBJECT].[MetadataObjectHash]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTBase].[MetadataObjectHash]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTOBJECT].[MetadataObjectRefreshUTCTimeStamp]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTAttribute]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTAttribute].[MetadataObjectHash]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTBase].[MetadataObjectHash]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTAttribute].[DataSetID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTBase].[DataSetID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTAttribute].[KEY]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTAttribute].[Value]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTAttribute].[KeyValueDataType]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTAttribute].[KeyValueRefreshDate]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTBase].[MetadataObjectRefreshUTCTimeStamp]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Entity]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Entity].[DataSetID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTEntity].[DataSetID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Entity].[MetadataEntityName]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTEntity].[MetadataEntityName]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Entity].[MetadataSchemaName]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTEntity].[MetadataSchemaName]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Entity].[TargetLake]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[ME_Config].[DataSet].[TargetLake]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Entity].[LakeFolder]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Entity].[RecordProcessTimestamp]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Object]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Object].[DataSetID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTOBJECT].[DataSetID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Object].[MetadataObjectName]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTOBJECT].[MetadataObjectName]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Object].[MetadataObjectOrder]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTOBJECT].[MetadataObjectOrder]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Object].[MetadataObjectHash]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTOBJECT].[MetadataObjectHash]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Object].[MetadataObjectRefreshUTCTimeStamp]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTOBJECT].[MetadataObjectRefreshUTCTimeStamp]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Object].[RecordProcessTimestamp]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Attribute]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Attribute].[MetadataObjectHash]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTAttribute].[MetadataObjectHash]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Attribute].[DataSetID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTAttribute].[DataSetID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Attribute].[KEY]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTAttribute].[KEY]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Attribute].[Value]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTAttribute].[Value]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Attribute].[KeyValueDataType]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTAttribute].[KeyValueDataType]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Attribute].[KeyValueRefreshDate]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#TTAttribute].[KeyValueRefreshDate]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[#Attribute].[RecordProcessTimestamp]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[ME_Data].[sp_ProcessDynamicStagedMetadata].[@DataSetType]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[ME_Data]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="10333" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROC [ME_Data].[sp_ProcessDynamicStagedMetadata] @DataSetType [VARCHAR](100) AS" />
			</Annotation>
		</Element>
		<Element Type="SqlSchema" Name="[ME_Secure]">
			<Relationship Name="Authorizer">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlTable" Name="[ME_Secure].[DL_Containers]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Secure].[DL_Containers].[Id]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bigint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Secure].[DL_Containers].[DLContainerName]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="500" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Secure].[DL_Containers].[DLstorageaccountname]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="500" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Secure].[DL_Containers].[DLKVSecretName]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="500" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Secure].[DL_Containers].[KeyVaultName]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1000" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[ME_Secure]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineIndexAnnotation" Disambiguator="9" />
		</Element>
		<Element Type="SqlColumnStoreIndex" Name="[ME_Secure].[DL_Containers].[ClusteredIndex_00000000000000000000000000000000]">
			<Property Name="IsClustered" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Secure].[DL_Containers].[Id]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Secure].[DL_Containers].[DLContainerName]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Secure].[DL_Containers].[DLstorageaccountname]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Secure].[DL_Containers].[DLKVSecretName]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Secure].[DL_Containers].[KeyVaultName]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[ME_Secure].[DL_Containers]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="9" />
		</Element>
		<Element Type="SqlTable" Name="[ME_Secure].[DW_Nodes]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Secure].[DW_Nodes].[Id]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bigint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Secure].[DW_Nodes].[DWName]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="500" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Secure].[DW_Nodes].[DWArcType]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Secure].[DW_Nodes].[DWHostName]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="500" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Secure].[DW_Nodes].[DWDBName]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="200" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Secure].[DW_Nodes].[DWUserName]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Secure].[DW_Nodes].[DWUserKVSecret]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[ME_Secure]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineIndexAnnotation" Disambiguator="10" />
		</Element>
		<Element Type="SqlColumnStoreIndex" Name="[ME_Secure].[DW_Nodes].[ClusteredIndex_00000000000000000000000000000000]">
			<Property Name="IsClustered" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Secure].[DW_Nodes].[Id]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Secure].[DW_Nodes].[DWName]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Secure].[DW_Nodes].[DWArcType]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Secure].[DW_Nodes].[DWHostName]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Secure].[DW_Nodes].[DWDBName]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Secure].[DW_Nodes].[DWUserName]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Secure].[DW_Nodes].[DWUserKVSecret]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[ME_Secure].[DW_Nodes]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="10" />
		</Element>
		<Element Type="SqlSchema" Name="[ME_Stage]">
			<Relationship Name="Authorizer">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlProcedure" Name="[ME_Stage].[InsertDataStageEntry]">
			<Property Name="BodyScript">
				<Value><![CDATA[ 
BEGIN

INSERT INTO  ME_Stage.RawPartitionStage
			(
			DatasetID,	Partition_String,	Row_Count,	InsertTimestamp
			)
SELECT		@DatasetID,	@Partition_String,	@Row_Count,	GETUTCDATE()

END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[ME_Stage].[RawPartitionStage]" />
				</Entry>
				<Entry>
					<References Name="[ME_Stage].[RawPartitionStage].[DatasetID]" />
				</Entry>
				<Entry>
					<References Name="[ME_Stage].[RawPartitionStage].[Partition_String]" />
				</Entry>
				<Entry>
					<References Name="[ME_Stage].[RawPartitionStage].[Row_Count]" />
				</Entry>
				<Entry>
					<References Name="[ME_Stage].[RawPartitionStage].[InsertTimestamp]" />
				</Entry>
				<Entry>
					<References Name="[ME_Stage].[InsertDataStageEntry].[@DatasetID]" />
				</Entry>
				<Entry>
					<References Name="[ME_Stage].[InsertDataStageEntry].[@Partition_String]" />
				</Entry>
				<Entry>
					<References Name="[ME_Stage].[InsertDataStageEntry].[@Row_Count]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[ME_Stage].[InsertDataStageEntry].[@Partition_String]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[ME_Stage].[InsertDataStageEntry].[@DatasetID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[ME_Stage].[InsertDataStageEntry].[@Row_Count]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bigint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[ME_Stage]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="313" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROC [ME_Stage].[InsertDataStageEntry] @Partition_String [VARCHAR](100),@DatasetID [INT],@Row_Count [BIGINT] AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[ME_Stage].[RawPartitionStage]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Stage].[RawPartitionStage].[Id]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bigint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Stage].[RawPartitionStage].[DatasetID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Stage].[RawPartitionStage].[Partition_String]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Stage].[RawPartitionStage].[Row_Count]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bigint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Stage].[RawPartitionStage].[InsertTimestamp]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="7" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime2]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[ME_Stage].[RawPartitionStage].[Status]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="2" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[ME_Stage]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineIndexAnnotation" Disambiguator="11" />
		</Element>
		<Element Type="SqlColumnStoreIndex" Name="[ME_Stage].[RawPartitionStage].[ClusteredIndex_00000000000000000000000000000000]">
			<Property Name="IsClustered" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Stage].[RawPartitionStage].[Id]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Stage].[RawPartitionStage].[DatasetID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Stage].[RawPartitionStage].[Partition_String]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Stage].[RawPartitionStage].[Row_Count]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Stage].[RawPartitionStage].[InsertTimestamp]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[ME_Stage].[RawPartitionStage].[Status]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[ME_Stage].[RawPartitionStage]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="11" />
		</Element>
		<Element Type="SqlProcedure" Name="[ME_Stage].[sp_DynamicODSLoad]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
	/*DEBUG
	declare @DatasetID [INT],@PARTITIONSTRING [VARCHAR](100)

		SET @DatasetID=53
*/
	/*DECLARE GLOBALS*/
	DECLARE @SOURCESCHEMA_STG VARCHAR(100)
	
		,@HasDelta INT
		,@HasBusinessKey INT
		,@EntityID BIGINT
		,@TARGETSCHEMA_ODS VARCHAR(MAX)
		,@TARGETTBL_ODS VARCHAR(MAX)
		,@SOURCEVW_STG VARCHAR(MAX)
		,@ODSEXISTS int 
		,@ODSSQL VARCHAR(MAX)
		,@VWDROP varchar(max)
	
	/*SET GLOBAL PARAMETERS*/
	SET @SOURCESCHEMA_STG = (SELECT TOP 1 AttributeValue	FROM ME_Config.GLOBALS WHERE [Attribute]='STAGE_SCHEMA')
	SET @EntityID = (SELECT id from Metadata.Entity where DatasetID=@DatasetID)
	SET @HasBusinessKey = (SELECT COUNT(1) FROM Metadata.Attribute where entityid=@EntityID and [KEY]='EntityRowIdentifier' )

	
    

		SET @SOURCEVW_STG =	(SELECT TOP 1 '['+@SOURCESCHEMA_STG+'].[vw_' + ConnectionName + '_' + e.SchemaName + '_' + e.Name + ']' 
								FROM METADATA.Entity E  INNER JOIN ME_Config.Dataset D ON D.ID=E.DatasetID
								INNER JOIN ME_Config.Connection C ON C.id=D.ConnectionID
								WHERE e.id=@EntityID
							)
		SET @TARGETSCHEMA_ODS = (SELECT TOP 1 ConnectionName + '_' + e.SchemaName 
								FROM METADATA.Entity E  INNER JOIN ME_Config.Dataset D ON D.ID=E.DatasetID
								INNER JOIN ME_Config.Connection C ON C.id=D.ConnectionID
								WHERE e.id=@EntityID)

		SET @TARGETTBL_ODS = (SELECT TOP 1 e.[name] FROM METADATA.Entity E 	WHERE e.id=@EntityID)

		SET @ODSEXISTS= (SELECT COUNT(1) FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE='BASE TABLE' AND TABLE_SCHEMA=@TARGETSCHEMA_ODS AND TABLE_NAME=@TARGETTBL_ODS)

	
	SET @ODSSQL =(SELECT 
	'BEGIN TRY DROP TABLE  ['+@TARGETSCHEMA_ODS+'].['+@TARGETTBL_ODS+'_new] END TRY
	 BEGIN CATCH PRINT 1 END CATCH
	
	CREATE TABLE ['+@TARGETSCHEMA_ODS+'].['+@TARGETTBL_ODS+'_new]
	 WITH
			(
			DISTRIBUTION = ROUND_ROBIN,
			CLUSTERED COLUMNSTORE INDEX
	  		
			)
	AS

	SELECT * FROM '+@SOURCEVW_STG+' 
	'+CASE WHEN @HasBusinessKey>0 AND @ODSEXISTS>0 then '
	UNION ALL
	SELECT * FROM ['+@TARGETSCHEMA_ODS+'].['+@TARGETTBL_ODS+'] WITH (NOLOCK)
	WHERE BusinessKeyHash_id NOT IN (SELECT BusinessKeyHash_id FROM '+@SOURCEVW_STG+');
    RENAME OBJECT ['+@TARGETSCHEMA_ODS+'].['+@TARGETTBL_ODS+'] TO ['+@TARGETTBL_ODS+'_OLD];
	RENAME OBJECT ['+@TARGETSCHEMA_ODS+'].['+@TARGETTBL_ODS+'_new] TO ['+@TARGETTBL_ODS+'];
	DROP TABLE ['+@TARGETSCHEMA_ODS+'].['+@TARGETTBL_ODS+'_OLD]
	DROP TABLE ['+@SOURCESCHEMA_STG+'].['+@TARGETSCHEMA_ODS+'_'+@TARGETTBL_ODS+'];' 
	 WHEN @HasBusinessKey <= 1 AND @ODSEXISTS>0 then '
	RENAME OBJECT ['+@TARGETSCHEMA_ODS+'].['+@TARGETTBL_ODS+'] TO ['+@TARGETTBL_ODS+'_OLD];
	RENAME OBJECT ['+@TARGETSCHEMA_ODS+'].['+@TARGETTBL_ODS+'_new] TO ['+@TARGETTBL_ODS+'];
	DROP TABLE ['+@TARGETSCHEMA_ODS+'].['+@TARGETTBL_ODS+'_OLD]
	DROP TABLE ['+@SOURCESCHEMA_STG+'].['+@TARGETSCHEMA_ODS+'_'+@TARGETTBL_ODS+'];' 
	ELSE '
	RENAME OBJECT ['+@TARGETSCHEMA_ODS+'].['+@TARGETTBL_ODS+'_new] TO ['+@TARGETTBL_ODS+'];
	DROP TABLE ['+@SOURCESCHEMA_STG+'].['+@TARGETSCHEMA_ODS+'_'+@TARGETTBL_ODS+'];'  
	 END)
    
	SET @VWDROP = 'BEGIN TRY DROP VIEW '+@SOURCEVW_STG+' END TRY  BEGIN CATCH PRINT 2 END CATCH'


	PRINT @ODSSQL
	PRINT @VWDROP
	
	EXEC (@ODSSQL)
	EXEC (@VWDROP)
	

END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bigint]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[GLOBALS]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[GLOBALS].[AttributeValue]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[GLOBALS].[Attribute]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[Id]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[DataSetId]" />
				</Entry>
				<Entry>
					<References Name="[ME_Stage].[sp_DynamicODSLoad].[@DatasetID]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[EntityId]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[KEY]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet].[Id]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[DataSetId]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[Connection]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[Connection].[Id]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet].[ConnectionId]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[Connection].[ConnectionName]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[SchemaName]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[Name]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[Id]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[Name]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[Id]" />
				</Entry>
				<Entry />
				<Entry />
				<Entry />
				<Entry />
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[ME_Stage].[sp_DynamicODSLoad].[@DatasetID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[ME_Stage]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="3311" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROC [ME_Stage].[sp_DynamicODSLoad] @DatasetID [INT] AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[ME_Stage].[sp_DynamicStageLoad]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
	/*DEBUG
	declare @DatasetID [INT],@PARTITIONSTRING [VARCHAR](100)
		SET @PARTITIONSTRING='2021/01/07/15/23'
		SET @DatasetID=53
*/
	/*DECLARE GLOBALS*/
	DECLARE @TARGETSCHEMA VARCHAR(100)
		,@STORAGE_ACCOUNT VARCHAR(500)
		,@BusinessKeyColConstruct VARCHAR(MAX)
		,@HasDelta INT
		,@HasBusinessKey INT
		,@EntityID BIGINT


	

	
	



	
	/*SET GLOBAL PARAMETERS*/
	SET @STORAGE_ACCOUNT =(SELECT TOP 1 AttributeValue	FROM ME_Config.GLOBALS WHERE [Attribute]='STORAGE_ACCOUNT')
	SET @TARGETSCHEMA = (SELECT TOP 1 AttributeValue	FROM ME_Config.GLOBALS WHERE [Attribute]='STAGE_SCHEMA')
	SET @EntityID = (SELECT id from Metadata.Entity where DatasetID=@DatasetID)
	SET @HasBusinessKey = (SELECT COUNT(1) FROM Metadata.Attribute where entityid=@EntityID and [KEY]='EntityRowIdentifier' )

	IF @HasBusinessKey > 0 	SET @BusinessKeyColConstruct =(SELECT REPLACE(',BusinessKeyHash_id = CONVERT(BIGINT,HASHBYTES(¬SHA1¬,CONCAT('+STRING_AGG('[' + o.[MetadataObjectName] + '],¬#!¬  ', ',') WITHIN GROUP (
									ORDER BY o.[MetadataObjectOrder] ASC
									) +'))) ','¬','''')
    FROM Metadata.Attribute C
	INNER JOIN Metadata.[Object] O ON C.[Value]=o.[MetadataObjectName] and O.entityid=C.entityid
	
	where C.entityid=@EntityID and 
	C.[KEY]='EntityRowIdentifier' 
	);



	/*DECLARE LOCAL PARAMETERS*/
	DECLARE @SQLCREATESTAGETABLE VARCHAR(MAX);
	DECLARE @SQLCREATESTAGEVIEW_1 VARCHAR(MAX);
	DECLARE @SQLCREATESTAGEVIEW_2 VARCHAR(MAX);
	DECLARE @SQLCOPYINTO VARCHAR(MAX);
	DECLARE @SQLSCHEMACREATE VARCHAR(MAX);
	DECLARE @SourceConnnectionName VARCHAR(250)
	

	/*Get Source Database / Connection Name for use in target table name*/
	SET @SourceConnnectionName = (
			SELECT TOP 1 [ConnectionName]
			FROM ME_CONFIG.Connection c
			INNER JOIN ME_Config.Dataset D ON D.ConnectionID = C.ID
				AND D.ID = @DatasetID
			)
	


	/*Ensure Stage schema exists as defined in MF_Config.Globals*/
	SET @SQLSCHEMACREATE = (SELECT REPLACE('BEGIN TRY DECLARE @X AS VARCHAR(4000) SET @X=¬CREATE SCHEMA '+@TARGETSCHEMA+' AUTHORIZATION dbo¬ EXEC (@X) END TRY BEGIN CATCH PRINT 1 END CATCH' ,'¬',''''))
	/*Flush Out Temp Tables*/
	
	BEGIN TRY
		DROP TABLE #TTBaseData
	END TRY

	BEGIN CATCH
		PRINT 1
	END CATCH
	
	/*Build out main metadata for dynamic SQL*/

	SELECT DISTINCT o.[Id]
		,o.[EntityId]
		,o.[DataSetID]
		,o.[MetadataObjectName]
		,o.[MetadataObjectOrder]
		,o.[MetadataObjectHash]
		,o.[MetadataObjectRefreshUTCTimeStamp]
		,o.[RecordProcessTimestamp]
		,o.[CreatedUTCTimestamp]
		,e.[TargetLake]
		,e.[LakeFolder]
		,e.[SchemaName]
		,EntityName = e.[Name]
		,[ObjectDataType] = DT.[Value]
		,[ObjectDataTypeSize] = DTL.[Value]
		,[ObjectDataTypePrecision] = DTP.[Value]
		,[ObjectDataTypeScale] = DTPS.[Value]
		,DATATYPE = [ME_Config].[fnGetDatatypedeff](DS.[DataSetType], DT.[Value], DTL.[Value], DTP.[Value], DTPS.[Value])
	INTO #TTBaseData
	FROM [Metadata].[Object] O
	INNER JOIN [ME_Config].[DataSet] DS ON O.DataSetId = DS.ID
	INNER JOIN Metadata.Entity E ON O.EntityId = E.id
		AND E.DatasetId = @DatasetID
	INNER JOIN [Metadata].[Attribute] DT ON o.id = DT.ObjectID
		AND DT.EntityId = E.id
		AND DT.[KEY] = 'ObjectDataType'
	INNER JOIN [Metadata].[Attribute] DTL ON o.id = DTL.ObjectID
		AND DTL.EntityId = E.id
		AND DTL.[KEY] = 'ObjectDataTypeSize'
	INNER JOIN [Metadata].[Attribute] DTP ON o.id = DTP.ObjectID
		AND DTP.EntityId = E.id
		AND DTP.[KEY] = 'ObjectDataTypePrecision'
	INNER JOIN [Metadata].[Attribute] DTPS ON o.id = DTPS.ObjectID
		AND DTP.EntityId = E.id
		AND DTPS.[KEY] = 'ObjectDataTypeScale'

/*Build out Copy Into Statement*/
	SET @SQLCOPYINTO = (
			SELECT TOP 1 REPLACE('COPY INTO [' + @TARGETSCHEMA + '].[' + @SourceConnnectionName + '_' + SchemaName + '_' + EntityName + ']
  
  FROM  ¬https://' + @STORAGE_ACCOUNT + '.dfs.core.windows.net/' + LOWER([TargetLake]) + CASE WHEN LEN([LakeFolder])=0 THEN '' ELSE '/' END + LOWER(REPLACE([LakeFolder], '\', '/')) + CASE WHEN LEN(@PARTITIONSTRING)=0 THEN'' ELSE '/' END + LOWER(REPLACE(@PARTITIONSTRING, '\', '/')) + '/*.parquet¬
  WITH
(
	FILE_TYPE = ¬PARQUET¬
	,MAXERRORS = 0
	,COMPRESSION = ¬snappy¬
	,IDENTITY_INSERT = ¬OFF¬
)

  ', '¬', '''')
			FROM #TTBaseData
			)
	
	/*Build Out Drop and Recreate of StageTable*/
	SET @SQLCREATESTAGETABLE = (
			SELECT 'BEGIN TRY DROP TABLE [' + @TARGETSCHEMA + '].[' + @SourceConnnectionName + '_' + SchemaName + '_' + EntityName + '] END TRY BEGIN CATCH PRINT 1 END CATCH 
		CREATE TABLE [' + @TARGETSCHEMA + '].[' + @SourceConnnectionName + '_' + SchemaName + '_' + EntityName + '] 
		( 
		' + CONVERT(NVARCHAR(MAX), (
						(
							STRING_AGG('[' + o.[MetadataObjectName] + '] ' + o.[DATATYPE] + ' ', ',') WITHIN GROUP (
									ORDER BY o.[MetadataObjectOrder] ASC
									)
							)
						)) + ') WITH
			(
			DISTRIBUTION = ROUND_ROBIN,
			/*CLUSTERED COLUMNSTORE INDEX*/
	  		HEAP
			)
			
			'
			FROM #TTBaseData o
			GROUP BY SchemaName
				,EntityName
			)


/*Build Out Drop and Recreate of StageView*/
	SET @SQLCREATESTAGEVIEW_1 = (
			SELECT 'BEGIN TRY DROP VIEW [' + @TARGETSCHEMA + '].[vw_' + @SourceConnnectionName + '_' + SchemaName + '_' + EntityName + '] END TRY BEGIN CATCH PRINT 1 END CATCH '
			FROM #TTBaseData o
			GROUP BY SchemaName
				,EntityName)

	SET @SQLCREATESTAGEVIEW_2 = (
			SELECT 'CREATE VIEW [' + @TARGETSCHEMA + '].[vw_' + @SourceConnnectionName + '_' + SchemaName + '_' + EntityName + '] 
		AS SELECT * '+ISNULL(@BusinessKeyColConstruct,' ') + 
		'FROM  [' + @TARGETSCHEMA + '].[' + @SourceConnnectionName + '_' + SchemaName + '_' + EntityName + ']'
		
			
		
			FROM #TTBaseData o
			GROUP BY SchemaName
				,EntityName
			)


/*Execute Dynamic SQL in sequence*/

	PRINT 'Creating Stage Table'
print @SQLCREATESTAGETABLE
	EXEC (@SQLCREATESTAGETABLE)
	
	PRINT 'Loading Stage Table'

	EXEC (@SQLCOPYINTO);
	PRINT 'Creating Stage View'
	Print @SQLCREATESTAGEVIEW_1
	EXEC (@SQLCREATESTAGEVIEW_1)
	Print @SQLCREATESTAGEVIEW_2
	EXEC (@SQLCREATESTAGEVIEW_2)

	BEGIN TRY
		DROP TABLE #TTBaseData
	END TRY

	BEGIN CATCH
		PRINT 1
	END CATCH
END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bigint]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[GLOBALS]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[GLOBALS].[AttributeValue]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[GLOBALS].[Attribute]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[Id]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[DataSetId]" />
				</Entry>
				<Entry>
					<References Name="[ME_Stage].[sp_DynamicStageLoad].[@DatasetID]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[EntityId]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[KEY]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Object]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[Value]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Object].[MetadataObjectName]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Object].[EntityId]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[EntityId]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Object].[MetadataObjectOrder]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[KEY]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[Connection]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet].[ConnectionId]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[Connection].[Id]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet].[Id]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[Connection].[ConnectionName]" />
				</Entry>
				<Entry>
					<References Name="[ME_Stage].[sp_DynamicStageLoad].[#TTBaseData]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Object].[DataSetID]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet].[Id]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Object].[EntityId]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[Id]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[DataSetId]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Object].[Id]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[ObjectId]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[EntityId]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[Id]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[KEY]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[ObjectId]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[EntityId]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[KEY]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[ObjectId]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[EntityId]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[KEY]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[ObjectId]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[KEY]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Object].[Id]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Object].[EntityId]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Object].[DataSetID]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Object].[MetadataObjectName]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Object].[MetadataObjectOrder]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Object].[MetadataObjectHash]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Object].[MetadataObjectRefreshUTCTimeStamp]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Object].[RecordProcessTimestamp]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Object].[CreatedUTCTimestamp]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[TargetLake]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[LakeFolder]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[SchemaName]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[Name]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[Value]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[Value]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[Value]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[Value]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[DataSet].[DataSetType]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[Value]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[Value]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[Value]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[Value]" />
				</Entry>
				<Entry>
					<References Name="[ME_Config].[fnGetDatatypedeff]" />
				</Entry>
				<Entry>
					<References Name="[ME_Stage].[sp_DynamicStageLoad].[#TTBaseData].[SchemaName]" />
				</Entry>
				<Entry>
					<References Name="[ME_Stage].[sp_DynamicStageLoad].[#TTBaseData].[EntityName]" />
				</Entry>
				<Entry>
					<References Name="[ME_Stage].[sp_DynamicStageLoad].[#TTBaseData].[TargetLake]" />
				</Entry>
				<Entry>
					<References Name="[ME_Stage].[sp_DynamicStageLoad].[#TTBaseData].[LakeFolder]" />
				</Entry>
				<Entry>
					<References Name="[ME_Stage].[sp_DynamicStageLoad].[@PARTITIONSTRING]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[ME_Stage].[sp_DynamicStageLoad].[#TTBaseData].[MetadataObjectName]" />
				</Entry>
				<Entry>
					<References Name="[ME_Stage].[sp_DynamicStageLoad].[#TTBaseData].[DATATYPE]" />
				</Entry>
				<Entry>
					<References Name="[ME_Stage].[sp_DynamicStageLoad].[#TTBaseData].[MetadataObjectOrder]" />
				</Entry>
			</Relationship>
			<Relationship Name="DynamicObjects">
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[ME_Stage].[sp_DynamicStageLoad].[#TTBaseData]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Stage].[sp_DynamicStageLoad].[#TTBaseData].[Id]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Metadata].[Object].[Id]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Stage].[sp_DynamicStageLoad].[#TTBaseData].[EntityId]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Metadata].[Object].[EntityId]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Stage].[sp_DynamicStageLoad].[#TTBaseData].[DataSetID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Metadata].[Object].[DataSetID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Stage].[sp_DynamicStageLoad].[#TTBaseData].[MetadataObjectName]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Metadata].[Object].[MetadataObjectName]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Stage].[sp_DynamicStageLoad].[#TTBaseData].[MetadataObjectOrder]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Metadata].[Object].[MetadataObjectOrder]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Stage].[sp_DynamicStageLoad].[#TTBaseData].[MetadataObjectHash]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Metadata].[Object].[MetadataObjectHash]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Stage].[sp_DynamicStageLoad].[#TTBaseData].[MetadataObjectRefreshUTCTimeStamp]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Metadata].[Object].[MetadataObjectRefreshUTCTimeStamp]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Stage].[sp_DynamicStageLoad].[#TTBaseData].[RecordProcessTimestamp]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Metadata].[Object].[RecordProcessTimestamp]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Stage].[sp_DynamicStageLoad].[#TTBaseData].[CreatedUTCTimestamp]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Metadata].[Object].[CreatedUTCTimestamp]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Stage].[sp_DynamicStageLoad].[#TTBaseData].[TargetLake]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Metadata].[Entity].[TargetLake]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Stage].[sp_DynamicStageLoad].[#TTBaseData].[LakeFolder]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Metadata].[Entity].[LakeFolder]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Stage].[sp_DynamicStageLoad].[#TTBaseData].[SchemaName]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Metadata].[Entity].[SchemaName]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Stage].[sp_DynamicStageLoad].[#TTBaseData].[EntityName]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Metadata].[Entity].[Name]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Stage].[sp_DynamicStageLoad].[#TTBaseData].[ObjectDataType]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Metadata].[Attribute].[Value]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Stage].[sp_DynamicStageLoad].[#TTBaseData].[ObjectDataTypeSize]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Metadata].[Attribute].[Value]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Stage].[sp_DynamicStageLoad].[#TTBaseData].[ObjectDataTypePrecision]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Metadata].[Attribute].[Value]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Stage].[sp_DynamicStageLoad].[#TTBaseData].[ObjectDataTypeScale]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Metadata].[Attribute].[Value]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[ME_Stage].[sp_DynamicStageLoad].[#TTBaseData].[DATATYPE]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[ME_Config].[fnGetDatatypedeff]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[ME_Stage].[sp_DynamicStageLoad].[@PARTITIONSTRING]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[ME_Stage].[sp_DynamicStageLoad].[@DatasetID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[ME_Stage]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="6296" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROC [ME_Stage].[sp_DynamicStageLoad] @PARTITIONSTRING [VARCHAR](100),@DatasetID [INT] AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[ME_Stage].[sp_GetStagePartitions]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
SELECT [Id]
      ,[DatasetID]
      ,[Partition_String]
      ,[Row_Count]
      ,[InsertTimestamp]
      ,[Status]
  FROM [ME_Stage].[RawPartitionStage]

  WHERE STATUS=0
  ORDER BY [InsertTimestamp]

  END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[ME_Stage].[RawPartitionStage]" />
				</Entry>
				<Entry>
					<References Name="[ME_Stage].[RawPartitionStage].[Id]" />
				</Entry>
				<Entry>
					<References Name="[ME_Stage].[RawPartitionStage].[DatasetID]" />
				</Entry>
				<Entry>
					<References Name="[ME_Stage].[RawPartitionStage].[Partition_String]" />
				</Entry>
				<Entry>
					<References Name="[ME_Stage].[RawPartitionStage].[Row_Count]" />
				</Entry>
				<Entry>
					<References Name="[ME_Stage].[RawPartitionStage].[InsertTimestamp]" />
				</Entry>
				<Entry>
					<References Name="[ME_Stage].[RawPartitionStage].[Status]" />
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[ME_Stage]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="277" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROC [ME_Stage].[sp_GetStagePartitions] AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[ME_Stage].[sp_UpdateStagePartition]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN

  UPDATE [ME_Stage].[RawPartitionStage]
  SET [Status]=@State

  WHERE id =@Partitionid


  END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[ME_Stage].[RawPartitionStage]" />
				</Entry>
				<Entry>
					<References Name="[ME_Stage].[RawPartitionStage].[Status]" />
				</Entry>
				<Entry>
					<References Name="[ME_Stage].[sp_UpdateStagePartition].[@State]" />
				</Entry>
				<Entry>
					<References Name="[ME_Stage].[RawPartitionStage].[Id]" />
				</Entry>
				<Entry>
					<References Name="[ME_Stage].[sp_UpdateStagePartition].[@Partitionid]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[ME_Stage].[sp_UpdateStagePartition].[@Partitionid]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[ME_Stage].[sp_UpdateStagePartition].[@State]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[ME_Stage]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="195" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROC [ME_Stage].[sp_UpdateStagePartition] @Partitionid [int],@State [Int] AS" />
			</Annotation>
		</Element>
		<Element Type="SqlSchema" Name="[Metadata]">
			<Relationship Name="Authorizer">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlTable" Name="[Metadata].[Attribute]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Metadata].[Attribute].[Id]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bigint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Metadata].[Attribute].[EntityId]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bigint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Metadata].[Attribute].[ObjectId]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bigint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Metadata].[Attribute].[MetadataObjectHash]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bigint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Metadata].[Attribute].[DataSetID]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Metadata].[Attribute].[KEY]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Metadata].[Attribute].[Value]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="4000" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Metadata].[Attribute].[KeyValueDataType]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Metadata].[Attribute].[KeyValueRefreshDate]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Metadata].[Attribute].[RecordProcessTimestamp]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Metadata].[Attribute].[CreatedUTCTimestamp]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Metadata]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineIndexAnnotation" Disambiguator="12" />
		</Element>
		<Element Type="SqlColumnStoreIndex" Name="[Metadata].[Attribute].[ClusteredIndex_00000000000000000000000000000000]">
			<Property Name="IsClustered" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Metadata].[Attribute].[Id]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Metadata].[Attribute].[EntityId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Metadata].[Attribute].[ObjectId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Metadata].[Attribute].[MetadataObjectHash]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Metadata].[Attribute].[DataSetID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Metadata].[Attribute].[KEY]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Metadata].[Attribute].[Value]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Metadata].[Attribute].[KeyValueDataType]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Metadata].[Attribute].[KeyValueRefreshDate]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Metadata].[Attribute].[RecordProcessTimestamp]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Metadata].[Attribute].[CreatedUTCTimestamp]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[Metadata].[Attribute]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="12" />
		</Element>
		<Element Type="SqlView" Name="[Metadata].[DeltaConfig]">
			<Property Name="QueryScript">
				<Value><![CDATA[ SELECT C.Entityid
	,WhereCol = C.[Value]
	,WhereOperator = o.[value]
	,wherevalue = ISNULL(v.[value], CASE 
			WHEN DT.[Value] LIKE '%DATE%'
				THEN '1900-01-01'
			ELSE '0'
			END)
FROM [Metadata].[Attribute] C WITH (NOLOCK)
INNER JOIN [Metadata].[Attribute] O WITH (NOLOCK) ON C.Entityid = O.Entityid
INNER JOIN [Metadata].[Attribute] V WITH (NOLOCK) ON C.Entityid = V.Entityid
INNER JOIN [Metadata].[Attribute] DT WITH (NOLOCK) ON C.Entityid = DT.Entityid
WHERE C.[Key] = 'EntityDeltaColumn'
	AND O.[Key] = 'EntityDeltaOperator'
	AND V.[Key] = 'EntityDeltaValue'
	AND DT.[Key] = 'EntityDeltaValueType']]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlComputedColumn" Name="[Metadata].[DeltaConfig].[Entityid]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[Metadata].[Attribute].[EntityId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[Metadata].[DeltaConfig].[WhereCol]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[Metadata].[Attribute].[Value]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[Metadata].[DeltaConfig].[WhereOperator]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[Metadata].[Attribute].[Value]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[Metadata].[DeltaConfig].[wherevalue]" />
				</Entry>
			</Relationship>
			<Relationship Name="QueryDependencies">
				<Entry>
					<References Name="[Metadata].[Attribute]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[EntityId]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[EntityId]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[EntityId]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[EntityId]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[Value]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[Value]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[Value]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[Value]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[KEY]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[KEY]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[KEY]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[KEY]" />
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Metadata]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="662" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE VIEW [Metadata].[DeltaConfig]&#xD;&#xA;AS" />
				<Property Name="FooterContents" Value=";" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[Metadata].[Entity]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Metadata].[Entity].[Id]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bigint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Metadata].[Entity].[DataSetId]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bigint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Metadata].[Entity].[Name]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="250" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Metadata].[Entity].[SchemaName]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="250" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Metadata].[Entity].[TargetLake]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="250" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Metadata].[Entity].[LakeFolder]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="2000" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Metadata].[Entity].[RecordProcessTimestamp]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Metadata].[Entity].[CreatedUTCTimestamp]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Metadata]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineIndexAnnotation" Disambiguator="13" />
		</Element>
		<Element Type="SqlColumnStoreIndex" Name="[Metadata].[Entity].[ClusteredIndex_00000000000000000000000000000000]">
			<Property Name="IsClustered" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Metadata].[Entity].[Id]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Metadata].[Entity].[DataSetId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Metadata].[Entity].[Name]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Metadata].[Entity].[SchemaName]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Metadata].[Entity].[TargetLake]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Metadata].[Entity].[LakeFolder]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Metadata].[Entity].[RecordProcessTimestamp]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Metadata].[Entity].[CreatedUTCTimestamp]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[Metadata].[Entity]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="13" />
		</Element>
		<Element Type="SqlTable" Name="[Metadata].[Object]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Metadata].[Object].[Id]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bigint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Metadata].[Object].[EntityId]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bigint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Metadata].[Object].[DataSetID]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="20" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Metadata].[Object].[MetadataObjectName]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="250" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Metadata].[Object].[MetadataObjectOrder]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Metadata].[Object].[MetadataObjectHash]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bigint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Metadata].[Object].[MetadataObjectRefreshUTCTimeStamp]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Metadata].[Object].[RecordProcessTimestamp]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Metadata].[Object].[CreatedUTCTimestamp]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Metadata]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineIndexAnnotation" Disambiguator="14" />
		</Element>
		<Element Type="SqlColumnStoreIndex" Name="[Metadata].[Object].[ClusteredIndex_00000000000000000000000000000000]">
			<Property Name="IsClustered" Value="True" />
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Metadata].[Object].[Id]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Metadata].[Object].[EntityId]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Metadata].[Object].[DataSetID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Metadata].[Object].[MetadataObjectName]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Metadata].[Object].[MetadataObjectOrder]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Metadata].[Object].[MetadataObjectHash]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Metadata].[Object].[MetadataObjectRefreshUTCTimeStamp]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Metadata].[Object].[RecordProcessTimestamp]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Metadata].[Object].[CreatedUTCTimestamp]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[Metadata].[Object]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="14" />
		</Element>
		<Element Type="SqlProcedure" Name="[Metadata].[sp_manage_UniqueKey_Attribute]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
	/*
--DEBUG
DECLARE @EntityId bigint , @DeltaColumn VARCHAR(MAX), @RowIdColumn VARCHAR(MAX), @DeltaOperator VARCHAR(MAX), @DeltaSeedValue VARCHAR(MAX)


SET @EntityId = 477
SET  @RowIdColumn = 'rowguid'
--SET  @DeltaColumn = 'ModifiedDate'
--SET  @DeltaOperator = '>='
--DEBUG
*/
	/*DECLARE CONSTANTS*/
	DECLARE @RIDKEY VARCHAR(MAX) = 'EntityRowIdentifier'
	/*Declare Globals*/
	DECLARE @DataSetID BIGINT
		,@DeltaDataType VARCHAR(MAX)

	SET @DataSetID = (
			SELECT DataSetID
			FROM [Metadata].[Entity]
			WHERE id = @EntityId
			)

	/*Flush Previous Data*/
	IF @ACTION = 'D'
		DELETE
		FROM [Metadata].[Attribute]
		WHERE ID IN (
				SELECT v.id
				FROM [Metadata].[Attribute] v
				WHERE v.[Key] = @RIDKEY
					AND v.Entityid = @EntityId
				)

	INSERT INTO [Metadata].[Attribute] (
		[EntityId]
		,[ObjectId]
		,[MetadataObjectHash]
		,[DataSetID]
		,[KEY]
		,[Value]
		,[KeyValueDataType]
		,[KeyValueRefreshDate]
		,[RecordProcessTimestamp]
		,[CreatedUTCTimestamp]
		)
	SELECT *
	FROM (
		SELECT [EntityId] = @EntityId
			,[ObjectId] = NULL
			,[MetadataObjectHash] = NULL
			,[DataSetID] = @DataSetID
			,[KEY] = @RIDKEY
			,[Value] = @RowIdColumn
			,[KeyValueDataType] = 'String'
			,[KeyValueRefreshDate] = getutcdate()
			,[RecordProcessTimestamp] = getutcdate()
			,[CreatedUTCTimestamp] = getutcdate()
		) AS XX

	SELECT v.*
	FROM [Metadata].[Attribute] v
	WHERE v.[Key] = @RIDKEY
		AND v.Entityid = @EntityId
END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bigint]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[DataSetId]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[Id]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[sp_manage_UniqueKey_Attribute].[@EntityId]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[sp_manage_UniqueKey_Attribute].[@ACTION]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[Id]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[Id]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[KEY]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[EntityId]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[EntityId]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[ObjectId]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[MetadataObjectHash]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[DataSetID]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[KEY]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[Value]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[KeyValueDataType]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[KeyValueRefreshDate]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[RecordProcessTimestamp]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[CreatedUTCTimestamp]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[sp_manage_UniqueKey_Attribute].[@RowIdColumn]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[KEY]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[EntityId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Metadata].[sp_manage_UniqueKey_Attribute].[@EntityId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bigint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Metadata].[sp_manage_UniqueKey_Attribute].[@RowIdColumn]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="IsMax" Value="True" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Metadata].[sp_manage_UniqueKey_Attribute].[@ACTION]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="10" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Metadata]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1628" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROC [Metadata].[sp_manage_UniqueKey_Attribute] @EntityId [bigint],@RowIdColumn [VARCHAR](MAX),@ACTION [VARCHAR](10) AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Metadata].[sp_prime_Delta_Attribute]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
	/*
--DEBUG
DECLARE @EntityId bigint , @DeltaColumn VARCHAR(MAX), @RowIdColumn VARCHAR(MAX), @DeltaOperator VARCHAR(MAX), @DeltaSeedValue VARCHAR(MAX)


SET @EntityId = 477
SET  @RowIdColumn = 'rowguid'
SET  @DeltaColumn = 'ModifiedDate'
SET  @DeltaOperator = '>='
--DEBUG
*/
	/*DECLARE CONSTANTS*/
	--DECLARE @RIDKEY VARCHAR(MAX) = 'EntityRowIdentifier'
	DECLARE @DeltaColumnKEY VARCHAR(MAX) = 'EntityDeltaColumn'
	DECLARE @DeltaOperatorKEY VARCHAR(MAX) = 'EntityDeltaOperator'
	DECLARE @DeltaValueKEY VARCHAR(MAX) = 'EntityDeltaValue'
	DECLARE @DeltaValueTypeKEY VARCHAR(MAX) = 'EntityDeltaValueType'
	/*DECLARE GLOBALS*/
	DECLARE @DataSetID BIGINT
		,@DeltaDataType VARCHAR(MAX)

	SET @DataSetID = (
			SELECT DataSetID
			FROM [Metadata].[Entity]
			WHERE id = @EntityId
			)
	/*GET Metadata*/
	SET @DeltaDataType = (
			SELECT v.[Value]
			FROM [Metadata].[Attribute] v
			INNER JOIN [Metadata].[Object] o ON o.id = v.Objectid
				AND o.[MetadataObjectName] = @DeltaColumn
				AND v.[Key] = 'ObjectDataType'
				AND v.Entityid = @EntityId
			)

	DELETE
	FROM [Metadata].[Attribute]
	WHERE ID IN (
			SELECT v.id
			FROM [Metadata].[Attribute] v
			WHERE v.[Key] IN (
					@DeltaColumnKEY
					,@DeltaOperatorKEY
					,@DeltaValueKEY
					,@DeltaValueTypeKEY
					)
				AND v.Entityid = @EntityId
			)

	INSERT INTO [Metadata].[Attribute] (
		[EntityId]
		,[ObjectId]
		,[MetadataObjectHash]
		,[DataSetID]
		,[KEY]
		,[Value]
		,[KeyValueDataType]
		,[KeyValueRefreshDate]
		,[RecordProcessTimestamp]
		,[CreatedUTCTimestamp]
		)
	SELECT *
	FROM (
		SELECT [EntityId] = @EntityId
			,[ObjectId] = NULL
			,[MetadataObjectHash] = NULL
			,[DataSetID] = @DataSetID
			,[KEY] = @DeltaColumnKEY
			,[Value] = @DeltaColumn
			,[KeyValueDataType] = 'String'
			,[KeyValueRefreshDate] = getutcdate()
			,[RecordProcessTimestamp] = getutcdate()
			,[CreatedUTCTimestamp] = getutcdate()
		
		UNION ALL
		
		SELECT [EntityId] = @EntityId
			,[ObjectId] = NULL
			,[MetadataObjectHash] = NULL
			,[DataSetID] = @DataSetID
			,[KEY] = @DeltaOperatorKEY
			,[Value] = @DeltaOperator
			,[KeyValueDataType] = 'String'
			,[KeyValueRefreshDate] = getutcdate()
			,[RecordProcessTimestamp] = getutcdate()
			,[CreatedUTCTimestamp] = getutcdate()
		
		UNION ALL
		
		SELECT [EntityId] = @EntityId
			,[ObjectId] = NULL
			,[MetadataObjectHash] = NULL
			,[DataSetID] = @DataSetID
			,[KEY] = @DeltaValueKEY
			,[Value] = @DeltaSeedValue
			,[KeyValueDataType] = 'String'
			,[KeyValueRefreshDate] = getutcdate()
			,[RecordProcessTimestamp] = getutcdate()
			,[CreatedUTCTimestamp] = getutcdate()
		
		UNION ALL
		
		SELECT [EntityId] = @EntityId
			,[ObjectId] = NULL
			,[MetadataObjectHash] = NULL
			,[DataSetID] = @DataSetID
			,[KEY] = @DeltaValueTypeKEY
			,[Value] = @DeltaDataType
			,[KeyValueDataType] = 'String'
			,[KeyValueRefreshDate] = getutcdate()
			,[RecordProcessTimestamp] = getutcdate()
			,[CreatedUTCTimestamp] = getutcdate()
		) AS XX

	SELECT v.*
	FROM [Metadata].[Attribute] v
	WHERE v.[Key] IN (
			@DeltaColumnKEY
			,@DeltaOperatorKEY
			,@DeltaValueKEY
			,@DeltaValueTypeKEY
			)
		AND v.Entityid = @EntityId
END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[bigint]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[DataSetId]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Entity].[Id]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[sp_prime_Delta_Attribute].[@EntityId]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Object]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Object].[Id]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[ObjectId]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Object].[MetadataObjectName]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[sp_prime_Delta_Attribute].[@DeltaColumn]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[KEY]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[EntityId]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[Value]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[Id]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[Id]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[KEY]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[EntityId]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[EntityId]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[ObjectId]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[MetadataObjectHash]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[DataSetID]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[KEY]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[Value]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[KeyValueDataType]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[KeyValueRefreshDate]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[RecordProcessTimestamp]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[CreatedUTCTimestamp]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[sp_prime_Delta_Attribute].[@DeltaOperator]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[sp_prime_Delta_Attribute].[@DeltaSeedValue]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[KEY]" />
				</Entry>
				<Entry>
					<References Name="[Metadata].[Attribute].[EntityId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Metadata].[sp_prime_Delta_Attribute].[@EntityId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bigint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Metadata].[sp_prime_Delta_Attribute].[@DeltaColumn]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="IsMax" Value="True" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Metadata].[sp_prime_Delta_Attribute].[@DeltaOperator]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="IsMax" Value="True" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Metadata].[sp_prime_Delta_Attribute].[@DeltaSeedValue]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="IsMax" Value="True" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Metadata]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="3425" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROC [Metadata].[sp_prime_Delta_Attribute] @EntityId [bigint],@DeltaColumn [VARCHAR](MAX),@DeltaOperator [VARCHAR](MAX),@DeltaSeedValue [VARCHAR](MAX) AS" />
			</Annotation>
		</Element>
	</Model>
</DataSchemaModel>